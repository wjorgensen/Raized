/*! For license information please see index.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.StacksStacking=e():t.StacksStacking=e()}(this,(()=>(()=>{var t,e,n={525:(t,e)=>{"use strict";function n(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function r(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)}function o(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function i(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");n(t.outputLen),n(t.blockLen)}function s(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function a(t,e){o(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(e,"__esModule",{value:!0}),e.output=e.exists=e.hash=e.bytes=e.bool=e.number=void 0,e.number=n,e.bool=r,e.bytes=o,e.hash=i,e.exists=s,e.output=a;const c={number:n,bool:r,bytes:o,hash:i,exists:s,output:a};e.default=c},350:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SHA2=void 0;const r=n(525),o=n(64);class i extends o.Hash{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,o.createView)(this.buffer)}update(t){r.default.exists(this);const{view:e,buffer:n,blockLen:i}=this,s=(t=(0,o.toBytes)(t)).length;for(let r=0;r<s;){const a=Math.min(i-this.pos,s-r);if(a!==i)n.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===i&&(this.process(e,0),this.pos=0);else{const e=(0,o.createView)(t);for(;i<=s-r;r+=i)this.process(e,r)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){r.default.exists(this),r.default.output(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:i,isLE:s}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(n,0),a=0);for(let t=a;t<i;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,i-8,BigInt(8*this.length),s),this.process(n,0);const c=(0,o.createView)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const h=u/4,d=this.get();if(h>d.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<h;t++)c.setUint32(4*t,d[t],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return t.length=r,t.pos=s,t.finished=o,t.destroyed=i,r%e&&t.buffer.set(n),t}}e.SHA2=i},661:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.crypto=void 0,e.crypto={node:void 0,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0}},53:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha224=e.sha256=void 0;const r=n(350),o=n(64),i=(t,e,n)=>t&e^t&n^e&n,s=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint32Array(64);class u extends r.SHA2{constructor(){super(64,32,8,!1),this.A=0|a[0],this.B=0|a[1],this.C=0|a[2],this.D=0|a[3],this.E=0|a[4],this.F=0|a[5],this.G=0|a[6],this.H=0|a[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[t,e,n,r,o,i,s,a]}set(t,e,n,r,o,i,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)c[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=c[t-15],n=c[t-2],r=(0,o.rotr)(e,7)^(0,o.rotr)(e,18)^e>>>3,i=(0,o.rotr)(n,17)^(0,o.rotr)(n,19)^n>>>10;c[t]=i+c[t-7]+r+c[t-16]|0}let{A:n,B:r,C:a,D:u,E:h,F:d,G:f,H:l}=this;for(let t=0;t<64;t++){const e=l+((0,o.rotr)(h,6)^(0,o.rotr)(h,11)^(0,o.rotr)(h,25))+((p=h)&d^~p&f)+s[t]+c[t]|0,y=((0,o.rotr)(n,2)^(0,o.rotr)(n,13)^(0,o.rotr)(n,22))+i(n,r,a)|0;l=f,f=d,d=h,h=u+e|0,u=a,a=r,r=n,n=e+y|0}var p;n=n+this.A|0,r=r+this.B|0,a=a+this.C|0,u=u+this.D|0,h=h+this.E|0,d=d+this.F|0,f=f+this.G|0,l=l+this.H|0,this.set(n,r,a,u,h,d,f,l)}roundClean(){c.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class h extends u{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}e.sha256=(0,o.wrapConstructor)((()=>new u)),e.sha224=(0,o.wrapConstructor)((()=>new h))},64:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const r=n(661);if(e.u8=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e.u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),e.createView=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),e.rotr=(t,e)=>t<<32-e|t>>>e,e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!e.isLE)throw new Error("Non little-endian hardware is not supported");const o=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function i(t){if("string"!=typeof t)throw new TypeError("utf8ToBytes expected string, got "+typeof t);return(new TextEncoder).encode(t)}function s(t){if("string"==typeof t&&(t=i(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}e.bytesToHex=function(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=o[t[n]];return e},e.hexToBytes=function(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const r=2*n,o=t.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[n]=i}return e},e.nextTick=async()=>{},e.asyncLoop=async function(t,n,r){let o=Date.now();for(let i=0;i<t;i++){r(i);const t=Date.now()-o;t>=0&&t<n||(await(0,e.nextTick)(),o+=t)}},e.utf8ToBytes=i,e.toBytes=s,e.concatBytes=function(...t){if(!t.every((t=>t instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){const o=t[e];n.set(o,r),r+=o.length}return n},e.Hash=class{clone(){return this._cloneInto()}},e.checkOpts=function(t,e){if(void 0!==e&&("object"!=typeof e||(n=e,"[object Object]"!==Object.prototype.toString.call(n)||n.constructor!==Object)))throw new TypeError("Options should be object or undefined");var n;return Object.assign(t,e)},e.wrapConstructor=function(t){const e=e=>t().update(s(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e},e.wrapConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(s(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e},e.randomBytes=function(t=32){if(r.crypto.web)return r.crypto.web.getRandomValues(new Uint8Array(t));if(r.crypto.node)return new Uint8Array(r.crypto.node.randomBytes(t).buffer);throw new Error("The environment doesn't have randomBytes function")}},166:t=>{"use strict";t.exports=function(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var r=0;r<t.length;r++){var o=t.charAt(r),i=o.charCodeAt(0);if(255!==e[i])throw new TypeError(o+" is ambiguous");e[i]=r}var s=t.length,a=t.charAt(0),c=Math.log(s)/Math.log(256),u=Math.log(256)/Math.log(s);function h(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;for(var n=0,r=0,o=0;t[n]===a;)r++,n++;for(var i=(t.length-n)*c+1>>>0,u=new Uint8Array(i);t[n];){var h=e[t.charCodeAt(n)];if(255===h)return;for(var d=0,f=i-1;(0!==h||d<o)&&-1!==f;f--,d++)h+=s*u[f]>>>0,u[f]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");o=d,n++}for(var l=i-o;l!==i&&0===u[l];)l++;for(var p=new Uint8Array(r+(i-l)),y=r;l!==i;)p[y++]=u[l++];return p}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var n=0,r=0,o=0,i=e.length;o!==i&&0===e[o];)o++,n++;for(var c=(i-o)*u+1>>>0,h=new Uint8Array(c);o!==i;){for(var d=e[o],f=0,l=c-1;(0!==d||f<r)&&-1!==l;l--,f++)d+=256*h[l]>>>0,h[l]=d%s>>>0,d=d/s>>>0;if(0!==d)throw new Error("Non-zero carry");r=f,o++}for(var p=c-r;p!==c&&0===h[p];)p++;for(var y=a.repeat(n);p<c;++p)y+=t.charAt(h[p]);return y},decodeUnsafe:h,decode:function(t){var e=h(t);if(e)return e;throw new Error("Non-base"+s+" character")}}}},766:(t,e)=>{"use strict";for(var n=[],r=[],o=("undefined"!=typeof Uint8Array&&Uint8Array,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),i=0;i<64;++i)n[i]=o[i],r[o.charCodeAt(i)]=i;r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},22:(t,e,n)=>{const r=n(166);t.exports=r("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},98:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.c32ToB58=e.b58ToC32=e.c32addressDecode=e.c32address=e.versions=void 0;const r=n(392),o=n(716),i=n(64);e.versions={mainnet:{p2pkh:22,p2sh:20},testnet:{p2pkh:26,p2sh:21}};const s={};s[0]=e.versions.mainnet.p2pkh,s[5]=e.versions.mainnet.p2sh,s[111]=e.versions.testnet.p2pkh,s[196]=e.versions.testnet.p2sh;const a={};function c(t,e){if(!e.match(/^[0-9a-fA-F]{40}$/))throw new Error("Invalid argument: not a hash160 hex string");return`S${(0,r.c32checkEncode)(t,e)}`}function u(t){if(t.length<=5)throw new Error("Invalid c32 address: invalid length");if("S"!=t[0])throw new Error('Invalid c32 address: must start with "S"');return(0,r.c32checkDecode)(t.slice(1))}a[e.versions.mainnet.p2pkh]=0,a[e.versions.mainnet.p2sh]=5,a[e.versions.testnet.p2pkh]=111,a[e.versions.testnet.p2sh]=196,e.c32address=c,e.c32addressDecode=u,e.b58ToC32=function(t,e=-1){const n=o.decode(t),r=(0,i.bytesToHex)(n.data),a=parseInt((0,i.bytesToHex)(n.prefix),16);let u;return e<0?(u=a,void 0!==s[a]&&(u=s[a])):u=e,c(u,r)},e.c32ToB58=function(t,e=-1){const n=u(t),r=n[0],i=n[1];let s;e<0?(s=r,void 0!==a[r]&&(s=a[r])):s=e;let c=s.toString(16);return 1===c.length&&(c=`0${c}`),o.encode(i,c)}},716:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.encode=void 0;const r=n(53),o=n(64),i=n(166),s="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";e.encode=function(t,e="00"){const n="string"==typeof t?(0,o.hexToBytes)(t):t,a="string"==typeof e?(0,o.hexToBytes)(e):t;if(!(n instanceof Uint8Array&&a instanceof Uint8Array))throw new TypeError("Argument must be of type Uint8Array or string");const c=(0,r.sha256)((0,r.sha256)(new Uint8Array([...a,...n])));return i(s).encode([...a,...n,...c.slice(0,4)])},e.decode=function(t){const e=i(s).decode(t),n=e.slice(0,1),o=e.slice(1,-4),a=(0,r.sha256)((0,r.sha256)(new Uint8Array([...n,...o])));return e.slice(-4).forEach(((t,e)=>{if(t!==a[e])throw new Error("Invalid checksum")})),{prefix:n,data:o}}},392:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.c32checkDecode=e.c32checkEncode=void 0;const r=n(53),o=n(64),i=n(103);function s(t){const e=(0,r.sha256)((0,r.sha256)((0,o.hexToBytes)(t)));return(0,o.bytesToHex)(e.slice(0,4))}e.c32checkEncode=function(t,e){if(t<0||t>=32)throw new Error("Invalid version (must be between 0 and 31)");if(!e.match(/^[0-9a-fA-F]*$/))throw new Error("Invalid data (not a hex string)");(e=e.toLowerCase()).length%2!=0&&(e=`0${e}`);let n=t.toString(16);1===n.length&&(n=`0${n}`);const r=s(`${n}${e}`),o=(0,i.c32encode)(`${e}${r}`);return`${i.c32[t]}${o}`},e.c32checkDecode=function(t){t=(0,i.c32normalize)(t);const e=(0,i.c32decode)(t.slice(1)),n=t[0],r=i.c32.indexOf(n),o=e.slice(-8);let a=r.toString(16);if(1===a.length&&(a=`0${a}`),s(`${a}${e.substring(0,e.length-8)}`)!==o)throw new Error("Invalid c32check string: checksum mismatch");return[r,e.substring(0,e.length-8)]}},103:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.c32decode=e.c32normalize=e.c32encode=e.c32=void 0;const r=n(64);e.c32="0123456789ABCDEFGHJKMNPQRSTVWXYZ";const o="0123456789abcdef";function i(t){return t.toUpperCase().replace(/O/g,"0").replace(/L|I/g,"1")}e.c32encode=function(t,n){if(!t.match(/^[0-9a-fA-F]*$/))throw new Error("Not a hex-encoded string");t.length%2!=0&&(t=`0${t}`);let i=[],s=0;for(let n=(t=t.toLowerCase()).length-1;n>=0;n--)if(s<4){const r=o.indexOf(t[n])>>s;let a=0;0!==n&&(a=o.indexOf(t[n-1]));const c=1+s,u=a%(1<<c)<<5-c,h=e.c32[r+u];s=c,i.unshift(h)}else s=0;let a=0;for(let t=0;t<i.length&&"0"===i[t];t++)a++;i=i.slice(a);const c=(new TextDecoder).decode((0,r.hexToBytes)(t)).match(/^\u0000*/),u=c?c[0].length:0;for(let t=0;t<u;t++)i.unshift(e.c32[0]);if(n){const t=n-i.length;for(let n=0;n<t;n++)i.unshift(e.c32[0])}return i.join("")},e.c32normalize=i,e.c32decode=function(t,n){if(!(t=i(t)).match(`^[${e.c32}]*$`))throw new Error("Not a c32-encoded string");const r=t.match(`^${e.c32[0]}*`),s=r?r[0].length:0;let a=[],c=0,u=0;for(let n=t.length-1;n>=0;n--){4===u&&(a.unshift(o[c]),u=0,c=0);const r=(e.c32.indexOf(t[n])<<u)+c,i=o[r%16];if(u+=1,c=r>>4,c>1<<u)throw new Error("Panic error in decoding.");a.unshift(i)}a.unshift(o[c]),a.length%2==1&&a.unshift("0");let h=0;for(let t=0;t<a.length&&"0"===a[t];t++)h++;a=a.slice(h-h%2);let d=a.join("");for(let t=0;t<s;t++)d=`00${d}`;if(n){const t=2*n-d.length;for(let e=0;e<t;e+=2)d=`00${d}`}return d}},870:(t,e,n)=>{"use strict";e.yI=e.H4=void 0;n(103),n(392);const r=n(98);Object.defineProperty(e,"H4",{enumerable:!0,get:function(){return r.c32address}}),Object.defineProperty(e,"yI",{enumerable:!0,get:function(){return r.c32addressDecode}})},616:function(){!function(t){!function(e){var n="URLSearchParams"in t,r="Symbol"in t&&"iterator"in Symbol,o="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),i="FormData"in t,s="ArrayBuffer"in t;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(t){return t&&a.indexOf(Object.prototype.toString.call(t))>-1};function u(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return"string"!=typeof t&&(t=String(t)),t}function d(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return r&&(e[Symbol.iterator]=function(){return e}),e}function f(t){this.map={},t instanceof f?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function l(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function y(t){var e=new FileReader,n=p(e);return e.readAsArrayBuffer(t),n}function g(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:o&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:i&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&o&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=g(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||c(t))?this._bodyArrayBuffer=g(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var t=l(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var t,e,n,r=l(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,n=p(e=new FileReader),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(t,e){t=u(t),e=h(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},f.prototype.delete=function(t){delete this.map[u(t)]},f.prototype.get=function(t){return t=u(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(u(t))},f.prototype.set=function(t,e){this.map[u(t)]=h(e)},f.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},f.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),d(t)},f.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),d(t)},f.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),d(t)},r&&(f.prototype[Symbol.iterator]=f.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function A(t,e){var n,r,o=(e=e||{}).body;if(t instanceof A){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,o||null==t._bodyInit||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=(r=(n=e.method||this.method||"GET").toUpperCase(),b.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function m(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}})),e}function E(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}A.prototype.clone=function(){return new A(this,{body:this._bodyInit})},w.call(A.prototype),w.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},E.error=function(){var t=new E(null,{status:0,statusText:""});return t.type="error",t};var S=[301,302,303,307,308];E.redirect=function(t,e){if(-1===S.indexOf(e))throw new RangeError("Invalid status code");return new E(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function x(t,n){return new Promise((function(r,i){var s=new A(t,n);if(s.signal&&s.signal.aborted)return i(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var t,e,n={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new f,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();e.append(r,o)}})),e)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;r(new E(o,n))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),s.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}x.polyfill=!0,t.fetch||(t.fetch=x,t.Headers=f,t.Request=A,t.Response=E),e.Headers=f,e.Request=A,e.Response=E,e.fetch=x,Object.defineProperty(e,"__esModule",{value:!0})}({})}("undefined"!=typeof self?self:this)},907:(t,e,n)=>{t=n.nmd(t);var r="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",s="[object Boolean]",a="[object Date]",c="[object Function]",u="[object GeneratorFunction]",h="[object Map]",d="[object Number]",f="[object Object]",l="[object Promise]",p="[object RegExp]",y="[object Set]",g="[object String]",w="[object Symbol]",b="[object WeakMap]",A="[object ArrayBuffer]",m="[object DataView]",E="[object Float32Array]",S="[object Float64Array]",x="[object Int8Array]",v="[object Int16Array]",I="[object Int32Array]",_="[object Uint8Array]",C="[object Uint8ClampedArray]",T="[object Uint16Array]",k="[object Uint32Array]",R=/\w*$/,P=/^\[object .+?Constructor\]$/,O=/^(?:0|[1-9]\d*)$/,B={};B[i]=B["[object Array]"]=B[A]=B[m]=B[s]=B[a]=B[E]=B[S]=B[x]=B[v]=B[I]=B[h]=B[d]=B[f]=B[p]=B[y]=B[g]=B[w]=B[_]=B[C]=B[T]=B[k]=!0,B["[object Error]"]=B[c]=B[b]=!1;var N="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,U="object"==typeof self&&self&&self.Object===Object&&self,H=N||U||Function("return this")(),D=e&&!e.nodeType&&e,$=D&&t&&!t.nodeType&&t,L=$&&$.exports===D;function K(t,e){return t.set(e[0],e[1]),t}function M(t,e){return t.add(e),t}function F(t,e,n,r){var o=-1,i=t?t.length:0;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}function j(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function G(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function W(t,e){return function(n){return t(e(n))}}function z(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var V,q=Array.prototype,X=Function.prototype,J=Object.prototype,Z=H["__core-js_shared__"],Y=(V=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"",Q=X.toString,tt=J.hasOwnProperty,et=J.toString,nt=RegExp("^"+Q.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rt=L?H.Buffer:void 0,ot=H.Symbol,it=H.Uint8Array,st=W(Object.getPrototypeOf,Object),at=Object.create,ct=J.propertyIsEnumerable,ut=q.splice,ht=Object.getOwnPropertySymbols,dt=rt?rt.isBuffer:void 0,ft=W(Object.keys,Object),lt=Ht(H,"DataView"),pt=Ht(H,"Map"),yt=Ht(H,"Promise"),gt=Ht(H,"Set"),wt=Ht(H,"WeakMap"),bt=Ht(Object,"create"),At=Mt(lt),mt=Mt(pt),Et=Mt(yt),St=Mt(gt),xt=Mt(wt),vt=ot?ot.prototype:void 0,It=vt?vt.valueOf:void 0;function _t(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ct(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Tt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function kt(t){this.__data__=new Ct(t)}function Rt(t,e,n){var r=t[e];tt.call(t,e)&&Ft(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function Pt(t,e){for(var n=t.length;n--;)if(Ft(t[n][0],e))return n;return-1}function Ot(t,e,n,r,o,l,b){var P;if(r&&(P=l?r(t,o,l,b):r(t)),void 0!==P)return P;if(!Vt(t))return t;var O=jt(t);if(O){if(P=function(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&tt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!e)return function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(t,P)}else{var N=$t(t),U=N==c||N==u;if(Wt(t))return function(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}(t,e);if(N==f||N==i||U&&!l){if(j(t))return l?t:{};if(P=function(t){return"function"!=typeof t.constructor||Kt(t)?{}:Vt(e=st(t))?at(e):{};var e}(U?{}:t),!e)return function(t,e){return Nt(t,Dt(t),e)}(t,function(t,e){return t&&Nt(e,qt(e),t)}(P,t))}else{if(!B[N])return l?t:{};P=function(t,e,n,r){var o,i=t.constructor;switch(e){case A:return Bt(t);case s:case a:return new i(+t);case m:return function(t,e){var n=e?Bt(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,r);case E:case S:case x:case v:case I:case _:case C:case T:case k:return function(t,e){var n=e?Bt(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}(t,r);case h:return function(t,e,n){return F(e?n(G(t),!0):G(t),K,new t.constructor)}(t,r,n);case d:case g:return new i(t);case p:return function(t){var e=new t.constructor(t.source,R.exec(t));return e.lastIndex=t.lastIndex,e}(t);case y:return function(t,e,n){return F(e?n(z(t),!0):z(t),M,new t.constructor)}(t,r,n);case w:return o=t,It?Object(It.call(o)):{}}}(t,N,Ot,e)}}b||(b=new kt);var H=b.get(t);if(H)return H;if(b.set(t,P),!O)var D=n?function(t){return function(t,e,n){var r=e(t);return jt(t)?r:function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}(r,n(t))}(t,qt,Dt)}(t):qt(t);return function(t,e){for(var n=-1,r=t?t.length:0;++n<r&&!1!==e(t[n],n););}(D||t,(function(o,i){D&&(o=t[i=o]),Rt(P,i,Ot(o,e,n,r,i,t,b))})),P}function Bt(t){var e=new t.constructor(t.byteLength);return new it(e).set(new it(t)),e}function Nt(t,e,n,r){n||(n={});for(var o=-1,i=e.length;++o<i;){var s=e[o],a=r?r(n[s],t[s],s,n,t):void 0;Rt(n,s,void 0===a?t[s]:a)}return n}function Ut(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function Ht(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!Vt(t)||(e=t,Y&&Y in e))&&(zt(t)||j(t)?nt:P).test(Mt(t));var e}(n)?n:void 0}_t.prototype.clear=function(){this.__data__=bt?bt(null):{}},_t.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},_t.prototype.get=function(t){var e=this.__data__;if(bt){var n=e[t];return n===r?void 0:n}return tt.call(e,t)?e[t]:void 0},_t.prototype.has=function(t){var e=this.__data__;return bt?void 0!==e[t]:tt.call(e,t)},_t.prototype.set=function(t,e){return this.__data__[t]=bt&&void 0===e?r:e,this},Ct.prototype.clear=function(){this.__data__=[]},Ct.prototype.delete=function(t){var e=this.__data__,n=Pt(e,t);return!(n<0||(n==e.length-1?e.pop():ut.call(e,n,1),0))},Ct.prototype.get=function(t){var e=this.__data__,n=Pt(e,t);return n<0?void 0:e[n][1]},Ct.prototype.has=function(t){return Pt(this.__data__,t)>-1},Ct.prototype.set=function(t,e){var n=this.__data__,r=Pt(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},Tt.prototype.clear=function(){this.__data__={hash:new _t,map:new(pt||Ct),string:new _t}},Tt.prototype.delete=function(t){return Ut(this,t).delete(t)},Tt.prototype.get=function(t){return Ut(this,t).get(t)},Tt.prototype.has=function(t){return Ut(this,t).has(t)},Tt.prototype.set=function(t,e){return Ut(this,t).set(t,e),this},kt.prototype.clear=function(){this.__data__=new Ct},kt.prototype.delete=function(t){return this.__data__.delete(t)},kt.prototype.get=function(t){return this.__data__.get(t)},kt.prototype.has=function(t){return this.__data__.has(t)},kt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Ct){var r=n.__data__;if(!pt||r.length<199)return r.push([t,e]),this;n=this.__data__=new Tt(r)}return n.set(t,e),this};var Dt=ht?W(ht,Object):function(){return[]},$t=function(t){return et.call(t)};function Lt(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||O.test(t))&&t>-1&&t%1==0&&t<e}function Kt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||J)}function Mt(t){if(null!=t){try{return Q.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ft(t,e){return t===e||t!=t&&e!=e}(lt&&$t(new lt(new ArrayBuffer(1)))!=m||pt&&$t(new pt)!=h||yt&&$t(yt.resolve())!=l||gt&&$t(new gt)!=y||wt&&$t(new wt)!=b)&&($t=function(t){var e=et.call(t),n=e==f?t.constructor:void 0,r=n?Mt(n):void 0;if(r)switch(r){case At:return m;case mt:return h;case Et:return l;case St:return y;case xt:return b}return e});var jt=Array.isArray;function Gt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}(t.length)&&!zt(t)}var Wt=dt||function(){return!1};function zt(t){var e=Vt(t)?et.call(t):"";return e==c||e==u}function Vt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function qt(t){return Gt(t)?function(t,e){var n=jt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&Gt(t)}(t)&&tt.call(t,"callee")&&(!ct.call(t,"callee")||et.call(t)==i)}(t)?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],r=n.length,o=!!r;for(var s in t)!e&&!tt.call(t,s)||o&&("length"==s||Lt(s,r))||n.push(s);return n}(t):function(t){if(!Kt(t))return ft(t);var e=[];for(var n in Object(t))tt.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}t.exports=function(t){return Ot(t,!0,!0)}},314:()=>{}},r={};function o(t){var e=r[t];if(void 0!==e)return e.exports;var i=r[t]={id:t,loaded:!1,exports:{}};return n[t].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,o.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var i=Object.create(null);o.r(i);var s={};t=t||[null,e({}),e([]),e(e)];for(var a=2&r&&n;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((t=>s[t]=()=>n[t]));return s.default=()=>n,o.d(i,s),i},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var i={};return(()=>{"use strict";function t(t,n,r){return c(e(t,n),r)}function e(t,e){let n=t;if("number"==typeof n){if(!Number.isInteger(n))throw new RangeError("Invalid value. Values of type 'number' must be an integer.");if(n>Number.MAX_SAFE_INTEGER)throw new RangeError(`Invalid value. Values of type 'number' must be less than or equal to ${Number.MAX_SAFE_INTEGER}. For larger values, try using a BigInt instead.`);return BigInt(n)}if("string"==typeof n)if(n.toLowerCase().startsWith("0x")){let t=n.slice(2);t=t.padStart(t.length+t.length%2,"0"),n=d(t)}else try{return BigInt(n)}catch(t){if(t instanceof SyntaxError)throw new RangeError(`Invalid value. String integer '${n}' is not finite.`)}if("bigint"==typeof n)return n;if(n instanceof Uint8Array){if(e){const t=function(t,e){return function(t,e){return t&BigInt(1)<<e}(t,e-BigInt(1))?t-(BigInt(1)<<e):t}(BigInt(`0x${h(n)}`),BigInt(8*n.byteLength));return BigInt(t.toString())}return BigInt(`0x${h(n)}`)}if(null!=n&&"object"==typeof n&&"BN"===n.constructor.name)return BigInt(n.toString());throw new TypeError("Invalid value type. Must be a number, bigint, integer-string, hex-string, or Uint8Array.")}function n(t){return t.startsWith("0x")?t:`0x${t}`}function r(t){if("string"!=typeof t)throw new TypeError("hexToBigInt: expected string, got "+typeof t);return BigInt(`0x${t}`)}function s(t,n=8){return("bigint"==typeof t?t:e(t,!1)).toString(16).padStart(2*n,"0")}function a(t){return parseInt(t,16)}function c(t,e=16){return d(s(t,e))}o.r(i),o.d(i,{InvalidAddressError:()=>xi,Pox4SignatureTopic:()=>Hi,StackingClient:()=>Vi,btcAddressVersionToLegacyHashMode:()=>vi,decodeBtcAddress:()=>Ii,ensureLegacyBtcAddressForPox1:()=>Ni,ensurePox2Activated:()=>Bi,ensureSignerArgsReadiness:()=>Ui,extractPoxAddressFromClarityValue:()=>_i,getErrorString:()=>Ci,pox4SignatureMessage:()=>Li,poxAddressToBtcAddress:()=>Ri,poxAddressToTuple:()=>Ti,signPox4SignatureHash:()=>Di,unwrap:()=>Pi,unwrapMap:()=>Oi,verifyPox4SignatureHash:()=>$i});const u=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function h(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(const n of t)e+=u[n];return e}function d(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);const e=t.length%2?`0${t}`:t,n=new Uint8Array(e.length/2);for(let t=0;t<n.length;t++){const r=2*t,o=e.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[t]=i}return n}function f(t){return(new TextEncoder).encode(t)}function l(t){return(new TextDecoder).decode(t)}function p(t){const e=[];for(let n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return new Uint8Array(e)}function y(t){return String.fromCharCode.apply(null,t)}function g(t){return!Number.isInteger(t)||t<0||t>255}function w(t){if(t.some(g))throw new Error("Some values are invalid bytes.");return new Uint8Array(t)}function b(...t){if(!t.every((t=>t instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){const o=t[e];n.set(o,r),r+=o.length}return n}function A(t){return b(...t.map((t=>"number"==typeof t?w([t]):t instanceof Array?w(t):t)))}var m,E,S,x;!function(t){t[t.Testnet=2147483648]="Testnet",t[t.Mainnet=1]="Mainnet"}(m||(m={})),(x=E||(E={}))[x.Mainnet=0]="Mainnet",x[x.Testnet=128]="Testnet",function(t){t[t.Mainnet=385875968]="Mainnet",t[t.Testnet=4278190080]="Testnet"}(S||(S={}));const v=33;o(616);const I={referrerPolicy:"origin",headers:{"x-hiro-product":"stacksjs"}};async function _(t,e){const n={};return Object.assign(n,I,e),await fetch(t,n)}function C(...t){const{fetchLib:e,middlewares:n}=function(t){let e=_,n=[];return t.length>0&&"function"==typeof t[0]&&(e=t.shift()),t.length>0&&(n=t),{fetchLib:e,middlewares:n}}(t);return async(t,r)=>{let o={url:t,init:r??{}};for(const t of n)"function"==typeof t.pre&&(o=await Promise.resolve(t.pre({fetch:e,...o}))??o);let i=await e(o.url,o.init);for(const t of n)if("function"==typeof t.post){const n=await Promise.resolve(t.post({fetch:e,url:o.url,init:o.init,response:i?.clone()??i}));i=n??i}return i}}const T=["mainnet","testnet","devnet","mocknet"];class k{constructor(t){this.version=E.Mainnet,this.chainId=m.Mainnet,this.bnsLookupUrl="https://api.mainnet.hiro.so",this.broadcastEndpoint="/v2/transactions",this.transferFeeEstimateEndpoint="/v2/fees/transfer",this.transactionFeeEstimateEndpoint="/v2/fees/transaction",this.accountEndpoint="/v2/accounts",this.contractAbiEndpoint="/v2/contracts/interface",this.readOnlyFunctionCallEndpoint="/v2/contracts/call-read",this.isMainnet=()=>this.version===E.Mainnet,this.getBroadcastApiUrl=()=>`${this.coreApiUrl}${this.broadcastEndpoint}`,this.getTransferFeeEstimateApiUrl=()=>`${this.coreApiUrl}${this.transferFeeEstimateEndpoint}`,this.getTransactionFeeEstimateApiUrl=()=>`${this.coreApiUrl}${this.transactionFeeEstimateEndpoint}`,this.getAccountApiUrl=t=>`${this.coreApiUrl}${this.accountEndpoint}/${t}?proof=0`,this.getAccountExtendedBalancesApiUrl=t=>`${this.coreApiUrl}/extended/v1/address/${t}/balances`,this.getAbiApiUrl=(t,e)=>`${this.coreApiUrl}${this.contractAbiEndpoint}/${t}/${e}`,this.getReadOnlyFunctionCallApiUrl=(t,e,n)=>`${this.coreApiUrl}${this.readOnlyFunctionCallEndpoint}/${t}/${e}/${encodeURIComponent(n)}`,this.getInfoUrl=()=>`${this.coreApiUrl}/v2/info`,this.getBlockTimeInfoUrl=()=>`${this.coreApiUrl}/extended/v1/info/network_block_times`,this.getPoxInfoUrl=()=>`${this.coreApiUrl}/v2/pox`,this.getRewardsUrl=(t,e)=>{let n=`${this.coreApiUrl}/extended/v1/burnchain/rewards/${t}`;return e&&(n=`${n}?limit=${e.limit}&offset=${e.offset}`),n},this.getRewardsTotalUrl=t=>`${this.coreApiUrl}/extended/v1/burnchain/rewards/${t}/total`,this.getRewardHoldersUrl=(t,e)=>{let n=`${this.coreApiUrl}/extended/v1/burnchain/reward_slot_holders/${t}`;return e&&(n=`${n}?limit=${e.limit}&offset=${e.offset}`),n},this.getStackerInfoUrl=(t,e)=>`${this.coreApiUrl}${this.readOnlyFunctionCallEndpoint}\n    ${t}/${e}/get-stacker-info`,this.getDataVarUrl=(t,e,n)=>`${this.coreApiUrl}/v2/data_var/${t}/${e}/${n}?proof=0`,this.getMapEntryUrl=(t,e,n)=>`${this.coreApiUrl}/v2/map_entry/${t}/${e}/${n}?proof=0`,this.coreApiUrl=t.url,this.fetchFn=t.fetchFn??C()}getNameInfo(t){const e=`${this.bnsLookupUrl}/v1/names/${t}`;return this.fetchFn(e).then((t=>{if(404===t.status)throw new Error("Name not found");if(200!==t.status)throw new Error(`Bad response status: ${t.status}`);return t.json()})).then((t=>t.address?Object.assign({},t,{address:t.address}):t))}}k.fromName=t=>{switch(t){case"mainnet":return new R;case"testnet":return new P;case"devnet":return new B;case"mocknet":return new O;default:throw new Error(`Invalid network name provided. Must be one of the following: ${T.join(", ")}`)}},k.fromNameOrNetwork=t=>"string"!=typeof t&&"version"in t?t:k.fromName(t);class R extends k{constructor(t){super({url:t?.url??"https://api.mainnet.hiro.so",fetchFn:t?.fetchFn}),this.version=E.Mainnet,this.chainId=m.Mainnet}}class P extends k{constructor(t){super({url:t?.url??"https://api.testnet.hiro.so",fetchFn:t?.fetchFn}),this.version=E.Testnet,this.chainId=m.Testnet}}class O extends k{constructor(t){super({url:t?.url??"http://localhost:3999",fetchFn:t?.fetchFn}),this.version=E.Testnet,this.chainId=m.Testnet}}const B=O;var N,U=o(870);function H(t,e){return t[e]}function D(t,e,n=0){return t[n]=e,t}function $(t,e,n=0){return t[n+3]=e,e>>>=8,t[n+2]=e,e>>>=8,t[n+1]=e,e>>>=8,t[n]=e,t}function L(t,e,n=0){return t[n+0]=255&e,e>>>=8,t[n+1]=255&e,e>>>=8,t[n+2]=255&e,e>>>=8,t[n+3]=255&e,t}!function(t){t[t.Testnet=2147483648]="Testnet",t[t.Mainnet=1]="Mainnet"}(N||(N={}));const K=N.Mainnet,M=128,F=128,j=16,G=65,W=34;var z,V,q,X,J,Z,Y,Q;(Q=z||(z={}))[Q.Address=0]="Address",Q[Q.Principal=1]="Principal",Q[Q.LengthPrefixedString=2]="LengthPrefixedString",Q[Q.MemoString=3]="MemoString",Q[Q.AssetInfo=4]="AssetInfo",Q[Q.PostCondition=5]="PostCondition",Q[Q.PublicKey=6]="PublicKey",Q[Q.LengthPrefixedList=7]="LengthPrefixedList",Q[Q.Payload=8]="Payload",Q[Q.MessageSignature=9]="MessageSignature",Q[Q.StructuredDataSignature=10]="StructuredDataSignature",Q[Q.TransactionAuthField=11]="TransactionAuthField",(Y=V||(V={}))[Y.TokenTransfer=0]="TokenTransfer",Y[Y.SmartContract=1]="SmartContract",Y[Y.VersionedSmartContract=6]="VersionedSmartContract",Y[Y.ContractCall=2]="ContractCall",Y[Y.PoisonMicroblock=3]="PoisonMicroblock",Y[Y.Coinbase=4]="Coinbase",Y[Y.CoinbaseToAltRecipient=5]="CoinbaseToAltRecipient",Y[Y.TenureChange=7]="TenureChange",Y[Y.NakamotoCoinbase=8]="NakamotoCoinbase",(Z=q||(q={}))[Z.Clarity1=1]="Clarity1",Z[Z.Clarity2=2]="Clarity2",(J=X||(X={}))[J.OnChainOnly=1]="OnChainOnly",J[J.OffChainOnly=2]="OffChainOnly",J[J.Any=3]="Any";const tt=["onChainOnly","offChainOnly","any"],et={[tt[0]]:X.OnChainOnly,[tt[1]]:X.OffChainOnly,[tt[2]]:X.Any,[X.OnChainOnly]:X.OnChainOnly,[X.OffChainOnly]:X.OffChainOnly,[X.Any]:X.Any};var nt,rt,ot,it,st,at,ct,ut,ht,dt,ft,lt,pt,yt,gt,wt,bt,At,mt,Et,St;function xt(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function vt(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}!function(t){t[t.Mainnet=0]="Mainnet",t[t.Testnet=128]="Testnet"}(nt||(nt={})),nt.Mainnet,(St=rt||(rt={}))[St.Allow=1]="Allow",St[St.Deny=2]="Deny",(Et=ot||(ot={}))[Et.STX=0]="STX",Et[Et.Fungible=1]="Fungible",Et[Et.NonFungible=2]="NonFungible",(mt=it||(it={}))[mt.Standard=4]="Standard",mt[mt.Sponsored=5]="Sponsored",(At=st||(st={}))[At.SerializeP2PKH=0]="SerializeP2PKH",At[At.SerializeP2SH=1]="SerializeP2SH",At[At.SerializeP2WPKH=2]="SerializeP2WPKH",At[At.SerializeP2WSH=3]="SerializeP2WSH",(bt=at||(at={}))[bt.MainnetSingleSig=22]="MainnetSingleSig",bt[bt.MainnetMultiSig=20]="MainnetMultiSig",bt[bt.TestnetSingleSig=26]="TestnetSingleSig",bt[bt.TestnetMultiSig=21]="TestnetMultiSig",(wt=ct||(ct={}))[wt.Compressed=0]="Compressed",wt[wt.Uncompressed=1]="Uncompressed",(gt=ut||(ut={}))[gt.Equal=1]="Equal",gt[gt.Greater=2]="Greater",gt[gt.GreaterEqual=3]="GreaterEqual",gt[gt.Less=4]="Less",gt[gt.LessEqual=5]="LessEqual",(yt=ht||(ht={}))[yt.Sends=16]="Sends",yt[yt.DoesNotSend=17]="DoesNotSend",(pt=dt||(dt={}))[pt.Origin=1]="Origin",pt[pt.Standard=2]="Standard",pt[pt.Contract=3]="Contract",function(t){t[t.STX=0]="STX",t[t.Fungible=1]="Fungible",t[t.NonFungible=2]="NonFungible"}(ft||(ft={})),function(t){t.Serialization="Serialization",t.Deserialization="Deserialization",t.SignatureValidation="SignatureValidation",t.FeeTooLow="FeeTooLow",t.BadNonce="BadNonce",t.NotEnoughFunds="NotEnoughFunds",t.NoSuchContract="NoSuchContract",t.NoSuchPublicFunction="NoSuchPublicFunction",t.BadFunctionArgument="BadFunctionArgument",t.ContractAlreadyExists="ContractAlreadyExists",t.PoisonMicroblocksDoNotConflict="PoisonMicroblocksDoNotConflict",t.PoisonMicroblockHasUnknownPubKeyHash="PoisonMicroblockHasUnknownPubKeyHash",t.PoisonMicroblockIsInvalid="PoisonMicroblockIsInvalid",t.BadAddressVersionByte="BadAddressVersionByte",t.NoCoinbaseViaMempool="NoCoinbaseViaMempool",t.ServerFailureNoSuchChainTip="ServerFailureNoSuchChainTip",t.TooMuchChaining="TooMuchChaining",t.ConflictingNonceInMempool="ConflictingNonceInMempool",t.BadTransactionVersion="BadTransactionVersion",t.TransferRecipientCannotEqualSender="TransferRecipientCannotEqualSender",t.TransferAmountMustBePositive="TransferAmountMustBePositive",t.ServerFailureDatabase="ServerFailureDatabase",t.EstimatorError="EstimatorError",t.TemporarilyBlacklisted="TemporarilyBlacklisted",t.ServerFailureOther="ServerFailureOther"}(lt||(lt={}));const It={number:xt,bool:function(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:vt,hash:function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");xt(t.outputLen),xt(t.blockLen)},exists:function(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")},output:function(t,e){vt(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}},_t=("object"==typeof self&&"crypto"in self&&self.crypto,t=>new DataView(t.buffer,t.byteOffset,t.byteLength)),Ct=(t,e)=>t<<32-e|t>>>e;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function Tt(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new TypeError("utf8ToBytes expected string, got "+typeof t);return(new TextEncoder).encode(t)}(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));class kt{clone(){return this._cloneInto()}}function Rt(t){const e=e=>t().update(Tt(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}class Pt extends kt{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=_t(this.buffer)}update(t){It.exists(this);const{view:e,buffer:n,blockLen:r}=this,o=(t=Tt(t)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(t.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(e,0),this.pos=0);else{const e=_t(t);for(;r<=o-i;i+=r)this.process(e,i)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){It.exists(this),It.output(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let t=i;t<r;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=_t(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return t.length=r,t.pos=s,t.finished=o,t.destroyed=i,r%e&&t.buffer.set(n),t}}const Ot=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Bt=Uint8Array.from({length:16},((t,e)=>e)),Nt=Bt.map((t=>(9*t+5)%16));let Ut=[Bt],Ht=[Nt];for(let t=0;t<4;t++)for(let e of[Ut,Ht])e.push(e[t].map((t=>Ot[t])));const Dt=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((t=>new Uint8Array(t))),$t=Ut.map(((t,e)=>t.map((t=>Dt[e][t])))),Lt=Ht.map(((t,e)=>t.map((t=>Dt[e][t])))),Kt=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),Mt=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),Ft=(t,e)=>t<<e|t>>>32-e;function jt(t,e,n,r){return 0===t?e^n^r:1===t?e&n|~e&r:2===t?(e|~n)^r:3===t?e&r|n&~r:e^(n|~r)}const Gt=new Uint32Array(16);class Wt extends Pt{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:n,h3:r,h4:o}=this;return[t,e,n,r,o]}set(t,e,n,r,o){this.h0=0|t,this.h1=0|e,this.h2=0|n,this.h3=0|r,this.h4=0|o}process(t,e){for(let n=0;n<16;n++,e+=4)Gt[n]=t.getUint32(e,!0);let n=0|this.h0,r=n,o=0|this.h1,i=o,s=0|this.h2,a=s,c=0|this.h3,u=c,h=0|this.h4,d=h;for(let t=0;t<5;t++){const e=4-t,f=Kt[t],l=Mt[t],p=Ut[t],y=Ht[t],g=$t[t],w=Lt[t];for(let e=0;e<16;e++){const r=Ft(n+jt(t,o,s,c)+Gt[p[e]]+f,g[e])+h|0;n=h,h=c,c=0|Ft(s,10),s=o,o=r}for(let t=0;t<16;t++){const n=Ft(r+jt(e,i,a,u)+Gt[y[t]]+l,w[t])+d|0;r=d,d=u,u=0|Ft(a,10),a=i,i=n}}this.set(this.h1+s+u|0,this.h2+c+d|0,this.h3+h+r|0,this.h4+n+i|0,this.h0+o+a|0)}roundClean(){Gt.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const zt=Rt((()=>new Wt)),Vt=(t,e,n)=>t&e^t&n^e&n,qt=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Xt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Jt=new Uint32Array(64);class Zt extends Pt{constructor(){super(64,32,8,!1),this.A=0|Xt[0],this.B=0|Xt[1],this.C=0|Xt[2],this.D=0|Xt[3],this.E=0|Xt[4],this.F=0|Xt[5],this.G=0|Xt[6],this.H=0|Xt[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[t,e,n,r,o,i,s,a]}set(t,e,n,r,o,i,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)Jt[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=Jt[t-15],n=Jt[t-2],r=Ct(e,7)^Ct(e,18)^e>>>3,o=Ct(n,17)^Ct(n,19)^n>>>10;Jt[t]=o+Jt[t-7]+r+Jt[t-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(Ct(s,6)^Ct(s,11)^Ct(s,25))+((h=s)&a^~h&c)+qt[t]+Jt[t]|0,d=(Ct(n,2)^Ct(n,13)^Ct(n,22))+Vt(n,r,o)|0;u=c,c=a,a=s,s=i+e|0,i=o,o=r,r=n,n=e+d|0}var h;n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){Jt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Yt extends Zt{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Qt=Rt((()=>new Zt)),te=(Rt((()=>new Yt)),BigInt(2**32-1)),ee=BigInt(32);function ne(t,e=!1){return e?{h:Number(t&te),l:Number(t>>ee&te)}:{h:0|Number(t>>ee&te),l:0|Number(t&te)}}const re=function(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let o=0;o<t.length;o++){const{h:i,l:s}=ne(t[o],e);[n[o],r[o]]=[i,s]}return[n,r]},oe=(t,e,n)=>t>>>n,ie=(t,e,n)=>t<<32-n|e>>>n,se=(t,e,n)=>t>>>n|e<<32-n,ae=(t,e,n)=>t<<32-n|e>>>n,ce=(t,e,n)=>t<<64-n|e>>>n-32,ue=(t,e,n)=>t>>>n-32|e<<64-n,he=function(t,e,n,r){const o=(e>>>0)+(r>>>0);return{h:t+n+(o/2**32|0)|0,l:0|o}},de=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),fe=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,le=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),pe=(t,e,n,r,o)=>e+n+r+o+(t/2**32|0)|0,ye=(t,e,n,r,o,i)=>e+n+r+o+i+(t/2**32|0)|0,ge=(t,e,n,r,o)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(o>>>0),[we,be]=re(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))),Ae=new Uint32Array(80),me=new Uint32Array(80);class Ee extends Pt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:n,Bl:r,Ch:o,Cl:i,Dh:s,Dl:a,Eh:c,El:u,Fh:h,Fl:d,Gh:f,Gl:l,Hh:p,Hl:y}=this;return[t,e,n,r,o,i,s,a,c,u,h,d,f,l,p,y]}set(t,e,n,r,o,i,s,a,c,u,h,d,f,l,p,y){this.Ah=0|t,this.Al=0|e,this.Bh=0|n,this.Bl=0|r,this.Ch=0|o,this.Cl=0|i,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|h,this.Fl=0|d,this.Gh=0|f,this.Gl=0|l,this.Hh=0|p,this.Hl=0|y}process(t,e){for(let n=0;n<16;n++,e+=4)Ae[n]=t.getUint32(e),me[n]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|Ae[t-15],n=0|me[t-15],r=se(e,n,1)^se(e,n,8)^oe(e,n,7),o=ae(e,n,1)^ae(e,n,8)^ie(e,n,7),i=0|Ae[t-2],s=0|me[t-2],a=se(i,s,19)^ce(i,s,61)^oe(i,s,6),c=ae(i,s,19)^ue(i,s,61)^ie(i,s,6),u=le(o,c,me[t-7],me[t-16]),h=pe(u,r,a,Ae[t-7],Ae[t-16]);Ae[t]=0|h,me[t]=0|u}let{Ah:n,Al:r,Bh:o,Bl:i,Ch:s,Cl:a,Dh:c,Dl:u,Eh:h,El:d,Fh:f,Fl:l,Gh:p,Gl:y,Hh:g,Hl:w}=this;for(let t=0;t<80;t++){const e=se(h,d,14)^se(h,d,18)^ce(h,d,41),b=ae(h,d,14)^ae(h,d,18)^ue(h,d,41),A=h&f^~h&p,m=ge(w,b,d&l^~d&y,be[t],me[t]),E=ye(m,g,e,A,we[t],Ae[t]),S=0|m,x=se(n,r,28)^ce(n,r,34)^ce(n,r,39),v=ae(n,r,28)^ue(n,r,34)^ue(n,r,39),I=n&o^n&s^o&s,_=r&i^r&a^i&a;g=0|p,w=0|y,p=0|f,y=0|l,f=0|h,l=0|d,({h,l:d}=he(0|c,0|u,0|E,0|S)),c=0|s,u=0|a,s=0|o,a=0|i,o=0|n,i=0|r;const C=de(S,v,_);n=fe(C,E,x,I),r=0|C}({h:n,l:r}=he(0|this.Ah,0|this.Al,0|n,0|r)),({h:o,l:i}=he(0|this.Bh,0|this.Bl,0|o,0|i)),({h:s,l:a}=he(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=he(0|this.Dh,0|this.Dl,0|c,0|u)),({h,l:d}=he(0|this.Eh,0|this.El,0|h,0|d)),({h:f,l}=he(0|this.Fh,0|this.Fl,0|f,0|l)),({h:p,l:y}=he(0|this.Gh,0|this.Gl,0|p,0|y)),({h:g,l:w}=he(0|this.Hh,0|this.Hl,0|g,0|w)),this.set(n,r,o,i,s,a,c,u,h,d,f,l,p,y,g,w)}roundClean(){Ae.fill(0),me.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Se extends Ee{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class xe extends Ee{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class ve extends Ee{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}Rt((()=>new Ee)),Rt((()=>new Se));const Ie=Rt((()=>new xe));Rt((()=>new ve));var _e=o(314),Ce=o.t(_e,2);const Te=BigInt(0),ke=BigInt(1),Re=BigInt(2),Pe=BigInt(3),Oe=BigInt(8),Be=Object.freeze({a:Te,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:ke,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Ne=(t,e)=>(t+e/Re)/e,Ue={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){const{n:e}=Be,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-ke*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=Ne(i*t,e),c=Ne(-r*t,e);let u=dn(t-a*n-c*o,e),h=dn(-a*r-c*i,e);const d=u>s,f=h>s;if(d&&(u=e-u),f&&(h=e-h),u>s||h>s)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:d,k1:u,k2neg:f,k2:h}}},He=32,De=32,$e=32,Le=He+1,Ke=2*He+1;function Me(t){const{a:e,b:n}=Be,r=dn(t*t),o=dn(r*t);return dn(o+e*t+n)}const Fe=Be.a===Te;class je extends Error{constructor(t){super(t)}}function Ge(t){if(!(t instanceof We))throw new TypeError("JacobianPoint expected")}class We{constructor(t,e,n){this.x=t,this.y=e,this.z=n}static fromAffine(t){if(!(t instanceof qe))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(qe.ZERO)?We.ZERO:new We(t.x,t.y,ke)}static toAffineBatch(t){const e=function(t,e=Be.P){const n=new Array(t.length),r=ln(t.reduce(((t,r,o)=>r===Te?t:(n[o]=t,dn(t*r,e))),ke),e);return t.reduceRight(((t,r,o)=>r===Te?t:(n[o]=dn(t*n[o],e),dn(t*r,e))),r),n}(t.map((t=>t.z)));return t.map(((t,n)=>t.toAffine(e[n])))}static normalizeZ(t){return We.toAffineBatch(t).map(We.fromAffine)}equals(t){Ge(t);const{x:e,y:n,z:r}=this,{x:o,y:i,z:s}=t,a=dn(r*r),c=dn(s*s),u=dn(e*c),h=dn(o*a),d=dn(dn(n*s)*c),f=dn(dn(i*r)*a);return u===h&&d===f}negate(){return new We(this.x,dn(-this.y),this.z)}double(){const{x:t,y:e,z:n}=this,r=dn(t*t),o=dn(e*e),i=dn(o*o),s=t+o,a=dn(Re*(dn(s*s)-r-i)),c=dn(Pe*r),u=dn(c*c),h=dn(u-Re*a),d=dn(c*(a-h)-Oe*i),f=dn(Re*e*n);return new We(h,d,f)}add(t){Ge(t);const{x:e,y:n,z:r}=this,{x:o,y:i,z:s}=t;if(o===Te||i===Te)return this;if(e===Te||n===Te)return t;const a=dn(r*r),c=dn(s*s),u=dn(e*c),h=dn(o*a),d=dn(dn(n*s)*c),f=dn(dn(i*r)*a),l=dn(h-u),p=dn(f-d);if(l===Te)return p===Te?this.double():We.ZERO;const y=dn(l*l),g=dn(l*y),w=dn(u*y),b=dn(p*p-g-Re*w),A=dn(p*(w-b)-d*g),m=dn(r*s*l);return new We(b,A,m)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){const e=We.ZERO;if("bigint"==typeof t&&t===Te)return e;let n=hn(t);if(n===ke)return this;if(!Fe){let t=e,r=this;for(;n>Te;)n&ke&&(t=t.add(r)),r=r.double(),n>>=ke;return t}let{k1neg:r,k1:o,k2neg:i,k2:s}=Ue.splitScalar(n),a=e,c=e,u=this;for(;o>Te||s>Te;)o&ke&&(a=a.add(u)),s&ke&&(c=c.add(u)),u=u.double(),o>>=ke,s>>=ke;return r&&(a=a.negate()),i&&(c=c.negate()),c=new We(dn(c.x*Ue.beta),c.y,c.z),a.add(c)}precomputeWindow(t){const e=Fe?128/t+1:256/t+1,n=[];let r=this,o=r;for(let i=0;i<e;i++){o=r,n.push(o);for(let e=1;e<2**(t-1);e++)o=o.add(r),n.push(o);r=o.double()}return n}wNAF(t,e){!e&&this.equals(We.BASE)&&(e=qe.BASE);const n=e&&e._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let r=e&&Ve.get(e);r||(r=this.precomputeWindow(n),e&&1!==n&&(r=We.normalizeZ(r),Ve.set(e,r)));let o=We.ZERO,i=We.BASE;const s=1+(Fe?128/n:256/n),a=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let e=0;e<s;e++){const n=e*a;let s=Number(t&c);t>>=h,s>a&&(s-=u,t+=ke);const d=n,f=n+Math.abs(s)-1,l=e%2!=0,p=s<0;0===s?i=i.add(ze(l,r[d])):o=o.add(ze(p,r[f]))}return{p:o,f:i}}multiply(t,e){let n,r,o=hn(t);if(Fe){const{k1neg:t,k1:i,k2neg:s,k2:a}=Ue.splitScalar(o);let{p:c,f:u}=this.wNAF(i,e),{p:h,f:d}=this.wNAF(a,e);c=ze(t,c),h=ze(s,h),h=new We(dn(h.x*Ue.beta),h.y,h.z),n=c.add(h),r=u.add(d)}else{const{p:t,f:i}=this.wNAF(o,e);n=t,r=i}return We.normalizeZ([n,r])[0]}toAffine(t){const{x:e,y:n,z:r}=this,o=this.equals(We.ZERO);null==t&&(t=o?Oe:ln(r));const i=t,s=dn(i*i),a=dn(s*i),c=dn(e*s),u=dn(n*a),h=dn(r*i);if(o)return qe.ZERO;if(h!==ke)throw new Error("invZ was invalid");return new qe(c,u)}}function ze(t,e){const n=e.negate();return t?n:e}We.BASE=new We(Be.Gx,Be.Gy,ke),We.ZERO=new We(Te,ke,Te);const Ve=new WeakMap;class qe{constructor(t,e){this.x=t,this.y=e}_setWindowSize(t){this._WINDOW_SIZE=t,Ve.delete(this)}hasEvenY(){return this.y%Re===Te}static fromCompressedHex(t){const e=32===t.length,n=cn(e?t:t.subarray(1));if(!An(n))throw new Error("Point is not on curve");let r=function(t){const{P:e}=Be,n=BigInt(6),r=BigInt(11),o=BigInt(22),i=BigInt(23),s=BigInt(44),a=BigInt(88),c=t*t*t%e,u=c*c*t%e,h=fn(u,Pe)*u%e,d=fn(h,Pe)*u%e,f=fn(d,Re)*c%e,l=fn(f,r)*f%e,p=fn(l,o)*l%e,y=fn(p,s)*p%e,g=fn(y,a)*y%e,w=fn(g,s)*p%e,b=fn(w,Pe)*u%e,A=fn(b,i)*l%e,m=fn(A,n)*c%e,E=fn(m,Re);if(E*E%e!==t)throw new Error("Cannot find square root");return E}(Me(n));const o=(r&ke)===ke;e?o&&(r=dn(-r)):1==(1&t[0])!==o&&(r=dn(-r));const i=new qe(n,r);return i.assertValidity(),i}static fromUncompressedHex(t){const e=cn(t.subarray(1,He+1)),n=cn(t.subarray(He+1,2*He+1)),r=new qe(e,n);return r.assertValidity(),r}static fromHex(t){const e=un(t),n=e.length,r=e[0];if(n===He)return this.fromCompressedHex(e);if(n===Le&&(2===r||3===r))return this.fromCompressedHex(e);if(n===Ke&&4===r)return this.fromUncompressedHex(e);throw new Error(`Point.fromHex: received invalid point. Expected 32-${Le} compressed bytes or ${Ke} uncompressed bytes, not ${n}`)}static fromPrivateKey(t){return qe.BASE.multiply(En(t))}static fromSignature(t,e,n){const{r,s:o}=Sn(e);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");const i=pn(un(t)),{n:s}=Be,a=2===n||3===n?r+s:r,c=ln(a,s),u=dn(-i*c,s),h=dn(o*c,s),d=1&n?"03":"02",f=qe.fromHex(d+nn(a)),l=qe.BASE.multiplyAndAddUnsafe(f,u,h);if(!l)throw new Error("Cannot recover signature: point at infinify");return l.assertValidity(),l}toRawBytes(t=!1){return an(this.toHex(t))}toHex(t=!1){const e=nn(this.x);return t?`${this.hasEvenY()?"02":"03"}${e}`:`04${e}${nn(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const t="Point is not on elliptic curve",{x:e,y:n}=this;if(!An(e)||!An(n))throw new Error(t);const r=dn(n*n);if(dn(r-Me(e))!==Te)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new qe(this.x,dn(-this.y))}double(){return We.fromAffine(this).double().toAffine()}add(t){return We.fromAffine(this).add(We.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return We.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,e,n){const r=We.fromAffine(this),o=e===Te||e===ke||this!==qe.BASE?r.multiplyUnsafe(e):r.multiply(e),i=We.fromAffine(t).multiplyUnsafe(n),s=o.add(i);return s.equals(We.ZERO)?void 0:s.toAffine()}}function Xe(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function Je(t){if(t.length<2||2!==t[0])throw new Error(`Invalid signature integer tag: ${tn(t)}`);const e=t[1],n=t.subarray(2,e+2);if(!e||n.length!==e)throw new Error("Invalid signature integer: wrong length");if(0===n[0]&&n[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:cn(n),left:t.subarray(e+2)}}qe.BASE=new qe(Be.Gx,Be.Gy),qe.ZERO=new qe(Te,Te);class Ze{constructor(t,e){this.r=t,this.s=e,this.assertValidity()}static fromCompact(t){const e=t instanceof Uint8Array,n="Signature.fromCompact";if("string"!=typeof t&&!e)throw new TypeError(`${n}: Expected string or Uint8Array`);const r=e?tn(t):t;if(128!==r.length)throw new Error(`${n}: Expected 64-byte hex`);return new Ze(sn(r.slice(0,64)),sn(r.slice(64,128)))}static fromDER(t){const e=t instanceof Uint8Array;if("string"!=typeof t&&!e)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:n,s:r}=function(t){if(t.length<2||48!=t[0])throw new Error(`Invalid signature tag: ${tn(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");const{data:e,left:n}=Je(t.subarray(2)),{data:r,left:o}=Je(n);if(o.length)throw new Error(`Invalid signature: left bytes after parsing: ${tn(o)}`);return{r:e,s:r}}(e?t:an(t));return new Ze(n,r)}static fromHex(t){return this.fromDER(t)}assertValidity(){const{r:t,s:e}=this;if(!bn(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!bn(e))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const t=Be.n>>ke;return this.s>t}normalizeS(){return this.hasHighS()?new Ze(this.r,dn(-this.s,Be.n)):this}toDERRawBytes(){return an(this.toDERHex())}toDERHex(){const t=Xe(on(this.s)),e=Xe(on(this.r)),n=t.length/2,r=e.length/2,o=on(n),i=on(r);return`30${on(r+n+4)}02${i}${e}02${o}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return an(this.toCompactHex())}toCompactHex(){return nn(this.r)+nn(this.s)}}function Ye(...t){if(!t.every((t=>t instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){const o=t[e];n.set(o,r),r+=o.length}return n}const Qe=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function tn(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let n=0;n<t.length;n++)e+=Qe[t[n]];return e}const en=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function nn(t){if("bigint"!=typeof t)throw new Error("Expected bigint");if(!(Te<=t&&t<en))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function rn(t){const e=an(nn(t));if(32!==e.length)throw new Error("Error: expected 32 bytes");return e}function on(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function sn(t){if("string"!=typeof t)throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function an(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const r=2*n,o=t.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[n]=i}return e}function cn(t){return sn(tn(t))}function un(t){return t instanceof Uint8Array?Uint8Array.from(t):an(t)}function hn(t){if("number"==typeof t&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if("bigint"==typeof t&&bn(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function dn(t,e=Be.P){const n=t%e;return n>=Te?n:e+n}function fn(t,e){const{P:n}=Be;let r=t;for(;e-- >Te;)r*=r,r%=n;return r}function ln(t,e=Be.P){if(t===Te||e<=Te)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=dn(t,e),r=e,o=Te,i=ke,s=ke,a=Te;for(;n!==Te;){const t=r/n,e=r%n,c=o-s*t,u=i-a*t;r=n,n=e,o=s,i=a,s=c,a=u}if(r!==ke)throw new Error("invert: does not exist");return dn(o,e)}function pn(t,e=!1){const n=function(t){const e=8*t.length-8*De,n=cn(t);return e>0?n>>BigInt(e):n}(t);if(e)return n;const{n:r}=Be;return n>=r?n-r:n}let yn,gn;class wn{constructor(t,e){if(this.hashLen=t,this.qByteLen=e,"number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}hmac(...t){return Rn.hmacSha256(this.k,...t)}hmacSync(...t){return gn(this.k,...t)}checkSync(){if("function"!=typeof gn)throw new je("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),0!==t.length&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),0!==t.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){this.incr();let t=0;const e=[];for(;t<this.qByteLen;){this.v=await this.hmac(this.v);const n=this.v.slice();e.push(n),t+=this.v.length}return Ye(...e)}generateSync(){this.checkSync(),this.incr();let t=0;const e=[];for(;t<this.qByteLen;){this.v=this.hmacSync(this.v);const n=this.v.slice();e.push(n),t+=this.v.length}return Ye(...e)}}function bn(t){return Te<t&&t<Be.n}function An(t){return Te<t&&t<Be.P}function mn(t,e,n,r=!0){const{n:o}=Be,i=pn(t,!0);if(!bn(i))return;const s=ln(i,o),a=qe.BASE.multiply(i),c=dn(a.x,o);if(c===Te)return;const u=dn(s*dn(e+n*c,o),o);if(u===Te)return;let h=new Ze(c,u),d=(a.x===h.r?0:2)|Number(a.y&ke);return r&&h.hasHighS()&&(h=h.normalizeS(),d^=1),{sig:h,recovery:d}}function En(t){let e;if("bigint"==typeof t)e=t;else if("number"==typeof t&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if("string"==typeof t){if(t.length!==2*De)throw new Error("Expected 32 bytes of private key");e=sn(t)}else{if(!(t instanceof Uint8Array))throw new TypeError("Expected valid private key");if(t.length!==De)throw new Error("Expected 32 bytes of private key");e=cn(t)}if(!bn(e))throw new Error("Expected private key: 0 < key < n");return e}function Sn(t){if(t instanceof Ze)return t.assertValidity(),t;try{return Ze.fromDER(t)}catch(e){return Ze.fromCompact(t)}}function xn(t){return cn(t.length>He?t.slice(0,He):t)}function vn(t){const e=xn(t),n=dn(e,Be.n);return In(n<Te?e:n)}function In(t){return rn(t)}const _n={strict:!0};function Cn(t,e,n,r=_n){let o;try{o=Sn(t),e=un(e)}catch(t){return!1}const{r:i,s}=o;if(r.strict&&o.hasHighS())return!1;const a=pn(e);let c;try{c=function(t){return t instanceof qe?(t.assertValidity(),t):qe.fromHex(t)}(n)}catch(t){return!1}const{n:u}=Be,h=ln(s,u),d=dn(a*h,u),f=dn(i*h,u),l=qe.BASE.multiplyAndAddUnsafe(c,d,f);return!!l&&dn(l.x,u)===i}qe.BASE._setWindowSize(8);const Tn={node:Ce,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},kn={},Rn={bytesToHex:tn,hexToBytes:an,concatBytes:Ye,mod:dn,invert:ln,isValidPrivateKey(t){try{return En(t),!0}catch(t){return!1}},_bigintTo32Bytes:rn,_normalizePrivateKey:En,hashToPrivateKey:t=>{t=un(t);const e=De+8;if(t.length<e||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");return rn(dn(cn(t),Be.n-ke)+ke)},randomBytes:(t=32)=>{if(Tn.web)return Tn.web.getRandomValues(new Uint8Array(t));if(Tn.node){const{randomBytes:e}=Tn.node;return Uint8Array.from(e(t))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Rn.hashToPrivateKey(Rn.randomBytes(De+8)),precompute(t=8,e=qe.BASE){const n=e===qe.BASE?e:new qe(e.x,e.y);return n._setWindowSize(t),n.multiply(Pe),n},sha256:async(...t)=>{if(Tn.web){const e=await Tn.web.subtle.digest("SHA-256",Ye(...t));return new Uint8Array(e)}if(Tn.node){const{createHash:e}=Tn.node,n=e("sha256");return t.forEach((t=>n.update(t))),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(Tn.web){const n=await Tn.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),r=Ye(...e),o=await Tn.web.subtle.sign("HMAC",n,r);return new Uint8Array(o)}if(Tn.node){const{createHmac:n}=Tn.node,r=n("sha256",t);return e.forEach((t=>r.update(t))),Uint8Array.from(r.digest())}throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let n=kn[t];if(void 0===n){const e=await Rn.sha256(Uint8Array.from(t,(t=>t.charCodeAt(0))));n=Ye(e,e),kn[t]=n}return Rn.sha256(n,...e)},taggedHashSync:(t,...e)=>{if("function"!=typeof yn)throw new je("sha256Sync is undefined, you need to set it");let n=kn[t];if(void 0===n){const e=yn(Uint8Array.from(t,(t=>t.charCodeAt(0))));n=Ye(e,e),kn[t]=n}return yn(n,...e)},_JacobianPoint:We};Object.defineProperties(Rn,{sha256Sync:{configurable:!1,get:()=>yn,set(t){yn||(yn=t)}},hmacSha256Sync:{configurable:!1,get:()=>gn,set(t){gn||(gn=t)}}});var Pn=o(907),On=o.n(Pn);class Bn extends kt{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,It.hash(t);const n=Tt(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let t=0;t<o.length;t++)o[t]^=54;this.iHash.update(o),this.oHash=t.create();for(let t=0;t<o.length;t++)o[t]^=106;this.oHash.update(o),o.fill(0)}update(t){return It.exists(this),this.iHash.update(t),this}digestInto(t){It.exists(this),It.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return t.finished=r,t.destroyed=o,t.blockLen=i,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Nn=(t,e,n)=>new Bn(t,e).update(n).digest();Nn.create=(t,e)=>new Bn(t,e);const Un=32;function Hn(t){if(t.length<2*Un*2+1)throw new Error("Invalid signature");const e=t.slice(0,2),n=t.slice(2,2+2*Un),r=t.slice(2+2*Un);return{recoveryId:a(e),r:n,s:r}}function Dn(t){return t.slice(-2)+t.slice(0,-2)}function $n(t,e){return{type:z.Address,version:t,hash160:e}}function Ln(t){return(0,U.H4)(t.version,t.hash160)}function Kn(t){return{type:z.PublicKey,data:d(t)}}function Mn(t){return!h(t.data).startsWith("04")}function Fn(t){return t.data.slice()}function jn(t){const e=Gn(t),n=function(t,e=!1){return qe.fromPrivateKey(t).toRawBytes(e)}(e.data.slice(0,32),e.compressed);return Kn(h(n))}function Gn(t){const e=function(t){const e="string"==typeof t?d(t):t;if(32!=e.length&&33!=e.length)throw new Error(`Improperly formatted private-key. Private-key byte length should be 32 or 33. Length provided: ${e.length}`);if(33==e.length&&1!==e[32])throw new Error("Improperly formatted private-key. 33 bytes indicate compressed key, but the last byte must be == 01");return e}(t);return{data:e,compressed:e.length==v}}function Wn(t,e){const[n,r]=function(t,e,n={}){const{seed:r,m:o,d:i}=function(t,e,n){if(null==t)throw new Error(`sign: expected valid message hash, not "${t}"`);const r=un(t),o=En(e),i=[In(o),vn(r)];if(null!=n){!0===n&&(n=Rn.randomBytes(He));const t=un(n);if(t.length!==He)throw new Error(`sign: Expected ${He} bytes of extra data`);i.push(t)}return{seed:Ye(...i),m:xn(r),d:o}}(t,e,n.extraEntropy),s=new wn($e,De);let a;for(s.reseedSync(r);!(a=mn(s.generateSync(),o,i,n.canonical));)s.reseedSync();return function(t,e){const{sig:n,recovery:r}=t,{der:o,recovered:i}=Object.assign({canonical:!0,der:!0},e),s=o?n.toDERRawBytes():n.toCompactRawBytes();return i?[s,r]:s}(a,n)}(e,t.data.slice(0,32),{canonical:!0,recovered:!0});if(null==r)throw new Error("No signature recoveryId received");return function(t){if(d(t).byteLength!=G)throw Error("Invalid signature");return{type:z.MessageSignature,data:t}}(s(r,1)+Ze.fromHex(n).toCompactHex())}function zn(t){return jn(t.data)}function Vn(t,e,n){const r=e||1,o=n||M;if(Kr(t,o))throw new Error(`String length exceeds maximum bytes ${o}`);return{type:z.LengthPrefixedString,content:t,lengthPrefixBytes:r,maxLengthBytes:o}}function qn(t){const e=(0,U.yI)(t);return{type:z.Address,version:e[0],hash160:e[1]}}var Xn,Jn,Zn,Yn;function Qn(){return{type:Xn.OptionalNone}}function tr(t){return{type:Xn.OptionalSome,value:t}}function er(e){const n=[];switch(n.push(e.payloadType),e.payloadType){case V.TokenTransfer:n.push(Sr(e.recipient)),n.push(t(e.amount,!1,8)),n.push(hr(e.memo));break;case V.ContractCall:n.push(hr(e.contractAddress)),n.push(hr(e.contractName)),n.push(hr(e.functionName));const r=new Uint8Array(4);$(r,e.functionArgs.length,0),n.push(r),e.functionArgs.forEach((t=>{n.push(Sr(t))}));break;case V.SmartContract:n.push(hr(e.contractName)),n.push(hr(e.codeBody));break;case V.VersionedSmartContract:n.push(e.clarityVersion),n.push(hr(e.contractName)),n.push(hr(e.codeBody));break;case V.PoisonMicroblock:break;case V.Coinbase:n.push(e.coinbaseBytes);break;case V.CoinbaseToAltRecipient:n.push(e.coinbaseBytes),n.push(Sr(e.recipient));break;case V.NakamotoCoinbase:n.push(e.coinbaseBytes),n.push(Sr(e.recipient?tr(e.recipient):Qn())),n.push(e.vrfProof);break;case V.TenureChange:n.push(d(e.tenureHash)),n.push(d(e.previousTenureHash)),n.push(d(e.burnViewHash)),n.push(d(e.previousTenureEnd)),n.push($(new Uint8Array(4),e.previousTenureBlocks)),n.push(D(new Uint8Array(1),e.cause)),n.push(d(e.publicKeyHash))}return A(n)}Rn.hmacSha256Sync=(t,...e)=>{const n=Nn.create(Qt,t);return e.forEach((t=>n.update(t))),n.digest()},(Yn=Xn||(Xn={}))[Yn.Int=0]="Int",Yn[Yn.UInt=1]="UInt",Yn[Yn.Buffer=2]="Buffer",Yn[Yn.BoolTrue=3]="BoolTrue",Yn[Yn.BoolFalse=4]="BoolFalse",Yn[Yn.PrincipalStandard=5]="PrincipalStandard",Yn[Yn.PrincipalContract=6]="PrincipalContract",Yn[Yn.ResponseOk=7]="ResponseOk",Yn[Yn.ResponseErr=8]="ResponseErr",Yn[Yn.OptionalNone=9]="OptionalNone",Yn[Yn.OptionalSome=10]="OptionalSome",Yn[Yn.List=11]="List",Yn[Yn.Tuple=12]="Tuple",Yn[Yn.StringASCII=13]="StringASCII",Yn[Yn.StringUTF8=14]="StringUTF8",function(t){t[t.BlockFound=0]="BlockFound",t[t.Extended=1]="Extended"}(Jn||(Jn={}));class nr extends Error{constructor(t){super(t),this.message=t,this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class rr extends nr{constructor(t){super(t)}}class or extends nr{constructor(t){super(t)}}class ir extends nr{constructor(t){super(t)}}class sr extends nr{constructor(t){super(t)}}class ar extends nr{constructor(t){super(t)}}function cr(t,e){return{pubKeyEncoding:t,type:z.TransactionAuthField,contents:e}}function ur(t){return d(t.data)}function hr(e){switch(e.type){case z.Address:return fr(e);case z.Principal:return pr(e);case z.LengthPrefixedString:return yr(e);case z.MemoString:return function(t){const e=[],n=f(t.content),r=Lr(h(n),2*W);return e.push(d(r)),A(e)}(e);case z.AssetInfo:return wr(e);case z.PostCondition:return function(e){const n=[];if(n.push(e.conditionType),n.push(pr(e.principal)),(e.conditionType===ot.Fungible||e.conditionType===ot.NonFungible)&&n.push(wr(e.assetInfo)),e.conditionType===ot.NonFungible&&n.push(Sr(e.assetName)),n.push(e.conditionCode),e.conditionType===ot.STX||e.conditionType===ot.Fungible){if(e.amount>BigInt("0xffffffffffffffff"))throw new rr("The post-condition amount may not be larger than 8 bytes");n.push(t(e.amount,!1,8))}return A(n)}(e);case z.PublicKey:return Fn(e);case z.LengthPrefixedList:return Ar(e);case z.Payload:return er(e);case z.TransactionAuthField:return function(t){const e=[];switch(t.contents.type){case z.PublicKey:t.pubKeyEncoding==ct.Compressed?(e.push(Zn.PublicKeyCompressed),e.push(Fn(t.contents))):(e.push(Zn.PublicKeyUncompressed),e.push(Fn(function(t){const e="string"==typeof t?t:h(t);return Kn(qe.fromHex(e).toHex(!0))}(t.contents.data))));break;case z.MessageSignature:t.pubKeyEncoding==ct.Compressed?e.push(Zn.SignatureCompressed):e.push(Zn.SignatureUncompressed),e.push(ur(t.contents))}return A(e)}(e);case z.MessageSignature:return ur(e)}}function dr(t,e,n,r){if(0===r.length)throw Error("Invalid number of public keys");if(!(e!==st.SerializeP2PKH&&e!==st.SerializeP2WPKH||1===r.length&&1===n))throw Error("Invalid number of public keys or signatures");if(e===st.SerializeP2WPKH||e===st.SerializeP2WSH)for(let t=0;t<r.length;t++)if(!Mn(r[t]))throw Error("Public keys must be compressed for segwit");switch(e){case st.SerializeP2PKH:return $n(t,Wr(r[0].data));case st.SerializeP2WPKH:return $n(t,zr(r[0].data));case st.SerializeP2SH:return $n(t,Vr(n,r.map(Fn)));case st.SerializeP2WSH:return $n(t,qr(n,r.map(Fn)))}}function fr(t){const e=[];return e.push(d(s(t.version,1))),e.push(d(t.hash160)),A(e)}function lr(t){const e=a(h(t.readBytes(1))),n=h(t.readBytes(20));return{type:z.Address,version:e,hash160:n}}function pr(t){const e=[];return e.push(t.prefix),e.push(fr(t.address)),t.prefix===dt.Contract&&e.push(yr(t.contractName)),A(e)}function yr(t){const e=[],n=f(t.content),r=n.byteLength;return e.push(d(s(r,t.lengthPrefixBytes))),e.push(n),A(e)}function gr(t,e,n){e=e||1;const r=a(h(t.readBytes(e)));return Vn(l(t.readBytes(r)),e,n??128)}function wr(t){const e=[];return e.push(fr(t.address)),e.push(yr(t.contractName)),e.push(yr(t.assetName)),A(e)}function br(t,e){return{type:z.LengthPrefixedList,lengthPrefixBytes:e||4,values:t}}function Ar(t){const e=t.values,n=[];n.push(d(s(e.length,t.lengthPrefixBytes)));for(const t of e)n.push(hr(t));return A(n)}function mr(t,e){return A([t,e])}function Er(t,e){const n=[],r="ascii"==e?p(t.data):f(t.data),o=new Uint8Array(4);return $(o,r.length,0),n.push(o),n.push(r),mr(t.type,A(n))}function Sr(t){switch(t.type){case Xn.BoolTrue:case Xn.BoolFalse:return function(t){return new Uint8Array([t.type])}(t);case Xn.OptionalNone:case Xn.OptionalSome:return(e=t).type===Xn.OptionalNone?new Uint8Array([e.type]):mr(e.type,Sr(e.value));case Xn.Buffer:return function(t){const e=new Uint8Array(4);return $(e,t.buffer.length,0),mr(t.type,b(e,t.buffer))}(t);case Xn.UInt:return function(t){const e=c(t.value,j);return mr(t.type,e)}(t);case Xn.Int:return function(t){const e=c(function(t,e){if(t<-(BigInt(1)<<e-BigInt(1))||(BigInt(1)<<e-BigInt(1))-BigInt(1)<t)throw`Unable to represent integer in width: ${e}`;return t>=BigInt(0)?BigInt(t):t+(BigInt(1)<<e)}(t.value,BigInt(F)),j);return mr(t.type,e)}(t);case Xn.PrincipalStandard:return function(t){return mr(t.type,fr(t.address))}(t);case Xn.PrincipalContract:return function(t){return mr(t.type,b(fr(t.address),yr(t.contractName)))}(t);case Xn.ResponseOk:case Xn.ResponseErr:return function(t){return mr(t.type,Sr(t.value))}(t);case Xn.List:return function(t){const e=[],n=new Uint8Array(4);$(n,t.list.length,0),e.push(n);for(const n of t.list){const t=Sr(n);e.push(t)}return mr(t.type,A(e))}(t);case Xn.Tuple:return function(t){const e=[],n=new Uint8Array(4);$(n,Object.keys(t.data).length,0),e.push(n);const r=Object.keys(t.data).sort(((t,e)=>t.localeCompare(e)));for(const n of r){const r=Vn(n);e.push(yr(r));const o=Sr(t.data[n]);e.push(o)}return mr(t.type,A(e))}(t);case Xn.StringASCII:return function(t){return Er(t,"ascii")}(t);case Xn.StringUTF8:return function(t){return Er(t,"utf8")}(t);default:throw new rr("Unable to serialize. Invalid Clarity Value.")}var e}!function(t){t[t.PublicKeyCompressed=0]="PublicKeyCompressed",t[t.PublicKeyUncompressed=1]="PublicKeyUncompressed",t[t.SignatureCompressed=2]="SignatureCompressed",t[t.SignatureUncompressed=3]="SignatureUncompressed"}(Zn||(Zn={}));const xr=BigInt("0xffffffffffffffffffffffffffffffff"),vr=BigInt(0),Ir=BigInt("0x7fffffffffffffffffffffffffffffff"),_r=BigInt("-170141183460469231731687303715884105728"),Cr=t=>{const n=e(t,!1);if(n<vr)throw new RangeError("Cannot construct unsigned clarity integer from negative value");if(n>xr)throw new RangeError(`Cannot construct unsigned clarity integer greater than ${xr}`);return{type:Xn.UInt,value:n}},Tr=t=>{if(t.byteLength>1048576)throw new Error("Cannot construct clarity buffer that is greater than 1MB");return{type:Xn.Buffer,buffer:t}};function kr(t){if(t.type===Xn.PrincipalStandard)return Ln(t.address);if(t.type===Xn.PrincipalContract)return`${Ln(t.address)}.${t.contractName.content}`;throw new Error(`Unexpected principal data: ${JSON.stringify(t)}`)}function Rr(t){if(t.includes(".")){const[e,n]=t.split(".");return function(t,e){return Pr(qn(t),Vn(e))}(e,n)}return function(t){const e=qn(t);return{type:Xn.PrincipalStandard,address:e}}(t)}function Pr(t,e){if(f(e.content).byteLength>=128)throw new Error("Contract name must be less than 128 bytes");return{type:Xn.PrincipalContract,address:t,contractName:e}}function Or(t){for(const n in t)if(!(/^[a-zA-Z]([a-zA-Z0-9]|[-_!?+<>=/*])*$|^[-+=/*]$|^[<>]=?$/.test(e=n)&&e.length<128))throw new Error(`"${n}" is not a valid Clarity name`);var e;return{type:Xn.Tuple,data:t}}const Br=new Map;function Nr(t,e){const n=Br.get(t);if(void 0!==n)return n(e);const r=function(t){const e=Object.values(t).filter((t=>"number"==typeof t)),n=new Set(e);return t=>n.has(t)}(t);return Br.set(t,r),Nr(t,e)}class Ur{constructor(t){this.consumed=0,this.source=t}readBytes(t){const e=this.source.subarray(this.consumed,this.consumed+t);return this.consumed+=t,e}readUInt32BE(){return(t=this.readBytes(4))[0]*2**24+65536*t[1]+256*t[2]+t[3];var t}readUInt8(){return H(this.readBytes(1),0)}readUInt16BE(){return((t=this.readBytes(2))[0+0]<<8|t[1])>>>0;var t}readBigUIntLE(t){const e=h(this.readBytes(t).slice().reverse());return BigInt(`0x${e}`)}readBigUIntBE(t){const e=h(this.readBytes(t));return BigInt(`0x${e}`)}get readOffset(){return this.consumed}set readOffset(t){this.consumed=t}get internalBytes(){return this.source}readUInt8Enum(t,e){const n=this.readUInt8();if(Nr(t,n))return n;throw e(n)}}const Hr=t=>({type:Xn.StringASCII,data:t});function Dr(t){let n;if("string"==typeof t){const e="0x"===t.slice(0,2).toLowerCase();n=new Ur(d(e?t.slice(2):t))}else n=t instanceof Uint8Array?new Ur(t):t;switch(n.readUInt8Enum(Xn,(t=>{throw new or(`Cannot recognize Clarity Type: ${t}`)}))){case Xn.Int:return(t=>{const n=e(t,!0);if(n>Ir)throw new RangeError(`Cannot construct clarity integer from value greater than ${Ir}`);if(n<_r)throw new RangeError(`Cannot construct clarity integer form value less than ${_r}`);return{type:Xn.Int,value:n}})(n.readBytes(16));case Xn.UInt:return Cr(n.readBytes(16));case Xn.Buffer:const t=n.readUInt32BE();return Tr(n.readBytes(t));case Xn.BoolTrue:return{type:Xn.BoolTrue};case Xn.BoolFalse:return{type:Xn.BoolFalse};case Xn.PrincipalStandard:return s=lr(n),{type:Xn.PrincipalStandard,address:s};case Xn.PrincipalContract:return Pr(lr(n),gr(n));case Xn.ResponseOk:return i=Dr(n),{type:Xn.ResponseOk,value:i};case Xn.ResponseErr:return function(t){return{type:Xn.ResponseErr,value:t}}(Dr(n));case Xn.OptionalNone:return Qn();case Xn.OptionalSome:return tr(Dr(n));case Xn.List:const a=n.readUInt32BE(),c=[];for(let t=0;t<a;t++)c.push(Dr(n));return o=c,{type:Xn.List,list:o};case Xn.Tuple:const u=n.readUInt32BE(),h={};for(let t=0;t<u;t++){const t=gr(n).content;if(void 0===t)throw new or('"content" is undefined');h[t]=Dr(n)}return Or(h);case Xn.StringASCII:const d=n.readUInt32BE(),f=y(n.readBytes(d));return Hr(f);case Xn.StringUTF8:const p=n.readUInt32BE(),g=l(n.readBytes(p));return r=g,{type:Xn.StringUTF8,data:r};default:throw new or("Unable to deserialize Clarity Value from Uint8Array. Could not find valid Clarity Type.")}var r,o,i,s}const $r=t=>t.length%2==0?t:`0${t}`,Lr=(t,e)=>t.padEnd(e,"0"),Kr=(t,e)=>!!t&&f(t).length>e;function Mr(t){return On()(t)}function Fr(t,e){const n=Mr(t);return delete n[e],n}const jr=t=>zt(Qt(t)),Gr=t=>h(Ie(t)),Wr=t=>h(jr(t)),zr=t=>{const e=jr(t),n=b(new Uint8Array([0]),new Uint8Array([e.length]),e);return h(jr(n))},Vr=(t,e)=>{if(t>15||e.length>15)throw Error("P2SH multisig address can only contain up to 15 public keys");const n=[];n.push(80+t),e.forEach((t=>{n.push(t.length),n.push(t)})),n.push(80+e.length),n.push(174);const r=A(n);return h(jr(r))},qr=(t,e)=>{if(t>15||e.length>15)throw Error("P2WSH multisig address can only contain up to 15 public keys");const n=[];n.push(80+t),e.forEach((t=>{n.push(t.length),n.push(t)})),n.push(80+e.length),n.push(174);const r=A(n),o=Qt(r),i=[];i.push(0),i.push(o.length),i.push(o);const s=A(i);return h(jr(s))};function Xr(){return{type:z.MessageSignature,data:h(new Uint8Array(G))}}function Jr(t,n,r,o){const i=dr(0,t,1,[Kn(n)]).hash160,s=Mn(Kn(n))?ct.Compressed:ct.Uncompressed;return{hashMode:t,signer:i,nonce:e(r,!1),fee:e(o,!1),keyEncoding:s,signature:Xr()}}function Zr(t){return"signature"in t}function Yr(t){const e=Mr(t);return e.nonce=0,e.fee=0,Zr(e)?e.signature=Xr():e.fields=[],{...e,nonce:BigInt(0),fee:BigInt(0)}}function Qr(e){return Zr(e)?function(e){return A([e.hashMode,d(e.signer),t(e.nonce,!1,8),t(e.fee,!1,8),e.keyEncoding,ur(e.signature)])}(e):function(e){const n=[e.hashMode,d(e.signer),t(e.nonce,!1,8),t(e.fee,!1,8)],r=br(e.fields);n.push(Ar(r));const o=new Uint8Array(2);return function(t,e,n=0){t[n+0]=e>>>8,t[n+1]=e>>>0}(o,e.signaturesRequired,0),n.push(o),A(n)}(e)}function to(e,n,r,o){const i=e+h(new Uint8Array([n]))+h(t(r,!1,8))+h(t(o,!1,8));if(49!==d(i).byteLength)throw Error("Invalid signature hash length");return Gr(d(i))}function eo(t,e,n){const r=33+G,o=Mn(e)?ct.Compressed:ct.Uncompressed,i=d(t+$r(o.toString(16))+n.data);if(i.byteLength>r)throw Error("Invalid signature hash length");return Gr(i)}function no(t,e,n,o,i,s){const a=to(t,e,n,o),c=Kn(function(t,e,n=ct.Compressed){const o=Hn(e.data),i=new Ze(r(o.r),r(o.s)),s=qe.fromSignature(t,i,o.recoveryId),a=n===ct.Compressed;return s.toHex(a)}(a,s,i));return{pubKey:c,nextSigHash:eo(a,c,s)}}function ro(t){return{authType:it.Standard,spendingCondition:t}}function oo(t,e){return{authType:it.Sponsored,spendingCondition:t,sponsorSpendingCondition:e||Jr(st.SerializeP2PKH,"0".repeat(66),0,0)}}function io(t){if(t.spendingCondition)switch(t.authType){case it.Standard:return ro(Yr(t.spendingCondition));case it.Sponsored:return oo(Yr(t.spendingCondition),function(){const t=Jr(st.SerializeP2PKH,"",0,0);return t.signer=(z.Address,at.MainnetSingleSig,"0".repeat(40)),t.keyEncoding=ct.Compressed,t.signature=Xr(),t}());default:throw new sr("Unexpected authorization type for signing")}throw new Error("Authorization missing SpendingCondition")}function so(t,e="hex"){switch(t.type){case Xn.BoolTrue:return"true";case Xn.BoolFalse:return"false";case Xn.Int:return t.value.toString();case Xn.UInt:return`u${t.value.toString()}`;case Xn.Buffer:if("tryAscii"===e){const e=y(t.buffer);if(/[ -~]/.test(e))return JSON.stringify(e)}return`0x${h(t.buffer)}`;case Xn.OptionalNone:return"none";case Xn.OptionalSome:return`(some ${so(t.value,e)})`;case Xn.ResponseErr:return`(err ${so(t.value,e)})`;case Xn.ResponseOk:return`(ok ${so(t.value,e)})`;case Xn.PrincipalStandard:case Xn.PrincipalContract:return kr(t);case Xn.List:return`(list ${t.list.map((t=>so(t,e))).join(" ")})`;case Xn.Tuple:return`(tuple ${Object.keys(t.data).map((n=>`(${n} ${so(t.data[n],e)})`)).join(" ")})`;case Xn.StringASCII:return`"${t.data}"`;case Xn.StringUTF8:return`u"${t.data}"`}}function ao(t){switch(t.type){case Xn.BoolTrue:case Xn.BoolFalse:return"bool";case Xn.Int:return"int";case Xn.UInt:return"uint";case Xn.Buffer:return`(buff ${t.buffer.length})`;case Xn.OptionalNone:return"(optional none)";case Xn.OptionalSome:return`(optional ${ao(t.value)})`;case Xn.ResponseErr:return`(response UnknownType ${ao(t.value)})`;case Xn.ResponseOk:return`(response ${ao(t.value)} UnknownType)`;case Xn.PrincipalStandard:case Xn.PrincipalContract:return"principal";case Xn.List:return`(list ${t.list.length} ${t.list.length?ao(t.list[0]):"UnknownType"})`;case Xn.Tuple:return`(tuple ${Object.keys(t.data).map((e=>`(${e} ${ao(t.data[e])})`)).join(" ")})`;case Xn.StringASCII:return`(string-ascii ${p(t.data).length})`;case Xn.StringUTF8:return`(string-utf8 ${f(t.data).length})`}}var co;!function(t){t[t.ClarityAbiTypeUInt128=1]="ClarityAbiTypeUInt128",t[t.ClarityAbiTypeInt128=2]="ClarityAbiTypeInt128",t[t.ClarityAbiTypeBool=3]="ClarityAbiTypeBool",t[t.ClarityAbiTypePrincipal=4]="ClarityAbiTypePrincipal",t[t.ClarityAbiTypeNone=5]="ClarityAbiTypeNone",t[t.ClarityAbiTypeBuffer=6]="ClarityAbiTypeBuffer",t[t.ClarityAbiTypeResponse=7]="ClarityAbiTypeResponse",t[t.ClarityAbiTypeOptional=8]="ClarityAbiTypeOptional",t[t.ClarityAbiTypeTuple=9]="ClarityAbiTypeTuple",t[t.ClarityAbiTypeList=10]="ClarityAbiTypeList",t[t.ClarityAbiTypeStringAscii=11]="ClarityAbiTypeStringAscii",t[t.ClarityAbiTypeStringUtf8=12]="ClarityAbiTypeStringUtf8",t[t.ClarityAbiTypeTraitReference=13]="ClarityAbiTypeTraitReference"}(co||(co={}));const uo=t=>"string"==typeof t,ho=t=>void 0!==t.buffer,fo=t=>void 0!==t["string-ascii"],lo=t=>void 0!==t["string-utf8"],po=t=>void 0!==t.response,yo=t=>void 0!==t.optional,go=t=>void 0!==t.tuple,wo=t=>void 0!==t.list;function bo(t){if(uo(t))return"int128"===t?"int":"uint128"===t?"uint":t;if(ho(t))return`(buff ${t.buffer.length})`;if(fo(t))return`(string-ascii ${t["string-ascii"].length})`;if(lo(t))return`(string-utf8 ${t["string-utf8"].length})`;if(po(t))return`(response ${bo(t.response.ok)} ${bo(t.response.error)})`;if(yo(t))return`(optional ${bo(t.optional)})`;if(go(t))return`(tuple ${t.tuple.map((t=>`(${t.name} ${bo(t.type)})`)).join(" ")})`;if(wo(t))return`(list ${t.list.length} ${bo(t.list.type)})`;throw new Error(`Type string unsupported for Clarity type: ${JSON.stringify(t)}`)}function Ao(t,e){const n=function(t){if(uo(t)){if("uint128"===t)return{id:co.ClarityAbiTypeUInt128,type:t};if("int128"===t)return{id:co.ClarityAbiTypeInt128,type:t};if("bool"===t)return{id:co.ClarityAbiTypeBool,type:t};if("principal"===t)return{id:co.ClarityAbiTypePrincipal,type:t};if("trait_reference"===t)return{id:co.ClarityAbiTypeTraitReference,type:t};if("none"===t)return{id:co.ClarityAbiTypeNone,type:t};throw new Error(`Unexpected Clarity ABI type primitive: ${JSON.stringify(t)}`)}if(ho(t))return{id:co.ClarityAbiTypeBuffer,type:t};if(po(t))return{id:co.ClarityAbiTypeResponse,type:t};if(yo(t))return{id:co.ClarityAbiTypeOptional,type:t};if(go(t))return{id:co.ClarityAbiTypeTuple,type:t};if(wo(t))return{id:co.ClarityAbiTypeList,type:t};if(fo(t))return{id:co.ClarityAbiTypeStringAscii,type:t};if(lo(t))return{id:co.ClarityAbiTypeStringUtf8,type:t};throw new Error(`Unexpected Clarity ABI type: ${JSON.stringify(t)}`)}(e);switch(t.type){case Xn.BoolTrue:case Xn.BoolFalse:return n.id===co.ClarityAbiTypeBool;case Xn.Int:return n.id===co.ClarityAbiTypeInt128;case Xn.UInt:return n.id===co.ClarityAbiTypeUInt128;case Xn.Buffer:return n.id===co.ClarityAbiTypeBuffer&&n.type.buffer.length>=t.buffer.length;case Xn.StringASCII:return n.id===co.ClarityAbiTypeStringAscii&&n.type["string-ascii"].length>=t.data.length;case Xn.StringUTF8:return n.id===co.ClarityAbiTypeStringUtf8&&n.type["string-utf8"].length>=t.data.length;case Xn.OptionalNone:return n.id===co.ClarityAbiTypeNone||n.id===co.ClarityAbiTypeOptional;case Xn.OptionalSome:return n.id===co.ClarityAbiTypeOptional&&Ao(t.value,n.type.optional);case Xn.ResponseErr:return n.id===co.ClarityAbiTypeResponse&&Ao(t.value,n.type.response.error);case Xn.ResponseOk:return n.id===co.ClarityAbiTypeResponse&&Ao(t.value,n.type.response.ok);case Xn.PrincipalContract:return n.id===co.ClarityAbiTypePrincipal||n.id===co.ClarityAbiTypeTraitReference;case Xn.PrincipalStandard:return n.id===co.ClarityAbiTypePrincipal;case Xn.List:return n.id==co.ClarityAbiTypeList&&n.type.list.length>=t.list.length&&t.list.every((t=>Ao(t,n.type.list.type)));case Xn.Tuple:if(n.id==co.ClarityAbiTypeTuple){const e=Mr(t.data);for(let t=0;t<n.type.tuple.length;t++){const r=n.type.tuple[t],o=r.name,i=e[o];if(!i)return!1;if(!Ao(i,r.type))return!1;delete e[o]}return!0}return!1;default:return!1}}class mo{constructor(t){this.transaction=t,this.sigHash=t.signBegin(),this.originDone=!1,this.checkOversign=!0,this.checkOverlap=!0;const e=t.auth.spendingCondition;if(e&&!Zr(e)){if(e.fields.filter((t=>t.contents.type===z.MessageSignature)).length>=e.signaturesRequired)throw new Error("SpendingCondition has more signatures than are expected");e.fields.forEach((n=>{if(n.contents.type===z.MessageSignature){const r=n.contents,o=no(this.sigHash,t.auth.authType,e.fee,e.nonce,ct.Compressed,r);this.sigHash=o.nextSigHash}}))}}static createSponsorSigner(t,e){if(t.auth.authType!=it.Sponsored)throw new sr("Cannot add sponsor to non-sponsored transaction");const n=Mr(t);n.setSponsor(e);const r=n.verifyOrigin(),o=new this(n);return o.originDone=!0,o.sigHash=r,o.checkOversign=!0,o.checkOverlap=!0,o}signOrigin(t){if(this.checkOverlap&&this.originDone)throw new sr("Cannot sign origin after sponsor key");if(void 0===this.transaction.auth)throw new sr('"transaction.auth" is undefined');if(void 0===this.transaction.auth.spendingCondition)throw new sr('"transaction.auth.spendingCondition" is undefined');if(!Zr(this.transaction.auth.spendingCondition)){const t=this.transaction.auth.spendingCondition;if(this.checkOversign&&t.fields.filter((t=>t.contents.type===z.MessageSignature)).length>=t.signaturesRequired)throw new Error("Origin would have too many signatures")}const e=this.transaction.signNextOrigin(this.sigHash,t);this.sigHash=e}appendOrigin(t){if(this.checkOverlap&&this.originDone)throw Error("Cannot append public key to origin after sponsor key");if(void 0===this.transaction.auth)throw new Error('"transaction.auth" is undefined');if(void 0===this.transaction.auth.spendingCondition)throw new Error('"transaction.auth.spendingCondition" is undefined');this.transaction.appendPubkey(t)}signSponsor(t){if(void 0===this.transaction.auth)throw new sr('"transaction.auth" is undefined');if(this.transaction.auth.authType!==it.Sponsored)throw new sr('"transaction.auth.authType" is not AuthType.Sponsored');const e=this.transaction.signNextSponsor(this.sigHash,t);this.sigHash=e,this.originDone=!0}getTxInComplete(){return Mr(this.transaction)}resume(t){this.transaction=Mr(t),this.sigHash=t.signBegin()}}class Eo{constructor(t,n,r,o,i,s,a){if(this.version=t,this.auth=n,this.payload="amount"in r?{...r,amount:e(r.amount,!1)}:r,this.chainId=a??K,this.postConditionMode=i??rt.Deny,this.postConditions=o??br([]),s)this.anchorMode=function(t){if(t in et)return et[t];throw new Error(`Invalid anchor mode "${t}", must be one of: ${tt.join(", ")}`)}(s);else switch(r.payloadType){case V.Coinbase:case V.CoinbaseToAltRecipient:case V.NakamotoCoinbase:case V.PoisonMicroblock:case V.TenureChange:this.anchorMode=X.OnChainOnly;break;case V.ContractCall:case V.SmartContract:case V.VersionedSmartContract:case V.TokenTransfer:this.anchorMode=X.Any}}signBegin(){const t=Mr(this);return t.auth=io(t.auth),t.txid()}verifyBegin(){const t=Mr(this);return t.auth=io(t.auth),t.txid()}verifyOrigin(){return function(t,e){switch(t.authType){case it.Standard:case it.Sponsored:return function(t,e,n){return Zr(t)?function(t,e,n){const{pubKey:r,nextSigHash:o}=no(e,n,t.fee,t.nonce,t.keyEncoding,t.signature),i=dr(0,t.hashMode,1,[r]).hash160;if(i!==t.signer)throw new ar(`Signer hash does not equal hash of public key(s): ${i} != ${t.signer}`);return o}(t,e,n):function(t,e,n){const r=[];let o=e,i=!1,s=0;for(const e of t.fields){let a;switch(e.contents.type){case z.PublicKey:Mn(e.contents)||(i=!0),a=e.contents;break;case z.MessageSignature:e.pubKeyEncoding===ct.Uncompressed&&(i=!0);const{pubKey:r,nextSigHash:c}=no(o,n,t.fee,t.nonce,e.pubKeyEncoding,e.contents);if(o=c,a=r,s+=1,65536===s)throw new ar("Too many signatures")}r.push(a)}if(s!==t.signaturesRequired)throw new ar("Incorrect number of signatures");if(i&&t.hashMode===st.SerializeP2SH)throw new ar("Uncompressed keys are not allowed in this hash mode");const a=dr(0,t.hashMode,t.signaturesRequired,r).hash160;if(a!==t.signer)throw new ar(`Signer hash does not equal hash of public key(s): ${a} != ${t.signer}`);return o}(t,e,n)}(t.spendingCondition,e,it.Standard);default:throw new sr("Invalid origin auth type")}}(this.auth,this.verifyBegin())}signNextOrigin(t,e){if(void 0===this.auth.spendingCondition)throw new Error('"auth.spendingCondition" is undefined');if(void 0===this.auth.authType)throw new Error('"auth.authType" is undefined');return this.signAndAppend(this.auth.spendingCondition,t,it.Standard,e)}signNextSponsor(t,e){if(this.auth.authType===it.Sponsored)return this.signAndAppend(this.auth.sponsorSpendingCondition,t,it.Sponsored,e);throw new Error('"auth.sponsorSpendingCondition" is undefined')}appendPubkey(t){const e=this.auth.spendingCondition;if(!e||Zr(e))throw new Error("Can't append public key to a singlesig condition");{const n=Mn(t);e.fields.push(cr(n?ct.Compressed:ct.Uncompressed,t))}}signAndAppend(t,e,n,r){const{nextSig:o,nextSigHash:i}=function(t,e,n,r,o){const i=to(t,e,n,r),s=Wn(o,i);return{nextSig:s,nextSigHash:eo(i,zn(o),s)}}(e,n,t.fee,t.nonce,r);if(Zr(t))t.signature=o;else{const e=h(r.data).endsWith("01");t.fields.push(cr(e?ct.Compressed:ct.Uncompressed,o))}return i}txid(){const t=this.serialize();return Gr(t)}setSponsor(t){if(this.auth.authType!=it.Sponsored)throw new sr("Cannot sponsor sign a non-sponsored transaction");this.auth=function(t,n){return{...t,sponsorSpendingCondition:{...n,nonce:e(n.nonce,!1),fee:e(n.fee,!1)}}}(this.auth,t)}setFee(t){this.auth=function(t,n){switch(t.authType){case it.Standard:const r={...t.spendingCondition,fee:e(n,!1)};return{...t,spendingCondition:r};case it.Sponsored:const o={...t.sponsorSpendingCondition,fee:e(n,!1)};return{...t,sponsorSpendingCondition:o}}}(this.auth,t)}setNonce(t){this.auth=function(t,n){const r={...t.spendingCondition,nonce:e(n,!1)};return{...t,spendingCondition:r}}(this.auth,t)}setSponsorNonce(t){if(this.auth.authType!=it.Sponsored)throw new sr("Cannot sponsor sign a non-sponsored transaction");this.auth=function(t,n){const r={...t.sponsorSpendingCondition,nonce:e(n,!1)};return{...t,sponsorSpendingCondition:r}}(this.auth,t)}serialize(){if(void 0===this.version)throw new rr('"version" is undefined');if(void 0===this.chainId)throw new rr('"chainId" is undefined');if(void 0===this.auth)throw new rr('"auth" is undefined');if(void 0===this.anchorMode)throw new rr('"anchorMode" is undefined');if(void 0===this.payload)throw new rr('"payload" is undefined');const t=[];t.push(this.version);const e=new Uint8Array(4);return $(e,this.chainId,0),t.push(e),t.push(function(t){const e=[];switch(e.push(t.authType),t.authType){case it.Standard:e.push(Qr(t.spendingCondition));break;case it.Sponsored:e.push(Qr(t.spendingCondition)),e.push(Qr(t.sponsorSpendingCondition))}return A(e)}(this.auth)),t.push(this.anchorMode),t.push(this.postConditionMode),t.push(Ar(this.postConditions)),t.push(er(this.payload)),A(t)}}async function So(t,e,r){const o=t.serialize(),i=k.fromNameOrNetwork(e??xo(t));return async function(t,e,r,o=C()){const i={method:"POST",headers:{"Content-Type":r?"application/json":"application/octet-stream"},body:r?JSON.stringify({tx:h(t),attachment:h(r)}):t},s=await o(e,i);if(!s.ok)try{return await s.json()}catch(t){throw Error(`Failed to broadcast transaction: ${t.message}`)}const a=await s.text(),c=a.replace(/["]+/g,"");if(!(t=>{if("success"===t)return!0;const e=n(t).toLowerCase();return 66===e.length&&n(BigInt(e).toString(16).padStart(64,"0"))===e})(c))throw new Error(a);return{txid:c}}(o,i.getBroadcastApiUrl(),r,i.fetchFn)}function xo(t){switch(t.version){case nt.Mainnet:return new R;case nt.Testnet:return new P}}async function vo(t){const n={fee:BigInt(0),nonce:BigInt(0),network:new R,postConditionMode:rt.Deny,sponsored:!1},r=Object.assign(n,t),o=(i=r.contractAddress,s=r.contractName,a=r.functionName,c=r.functionArgs,"string"==typeof i&&(i=qn(i)),"string"==typeof s&&(s=Vn(s)),"string"==typeof a&&(a=Vn(a)),{type:z.Payload,payloadType:V.ContractCall,contractAddress:i,contractName:s,functionName:a,functionArgs:c});var i,s,a,c;if(r?.validateWithAbi){let t;if("boolean"==typeof r.validateWithAbi){if(!r?.network)throw new Error("Network option must be provided in order to validate with ABI");t=await async function(t,e,n){const r=k.fromNameOrNetwork(n),o=r.getAbiApiUrl(t,e),i=await r.fetchFn(o,{method:"GET"});if(!i.ok){const n=await i.text().catch((()=>""));throw new Error(`Error fetching contract ABI for contract "${e}" at address ${t}. Response ${i.status}: ${i.statusText}. Attempted to fetch ${o} and failed with the message: "${n}"`)}return JSON.parse(await i.text())}(r.contractAddress,r.contractName,r.network)}else t=r.validateWithAbi;!function(t,e){const n=e.functions.filter((e=>e.name===t.functionName.content));if(1===n.length){const e=n[0].args;if(t.functionArgs.length!==e.length)throw new Error(`Clarity function expects ${e.length} argument(s) but received ${t.functionArgs.length}`);for(let n=0;n<t.functionArgs.length;n++){const r=t.functionArgs[n],o=e[n];if(!Ao(r,o.type)){const e=n+1;throw new Error(`Clarity function \`${t.functionName.content}\` expects argument ${e} to be of type ${bo(o.type)}, not ${ao(r)}`)}}return!0}throw 0===n.length?new Error(`ABI doesn't contain a function with the name ${t.functionName.content}`):new Error(`Malformed ABI. Contains multiple functions with the name ${t.functionName.content}`)}(o,t)}let u=null,d=null;var f,l,p,y,g;"publicKey"in r?u=Jr(st.SerializeP2PKH,r.publicKey,r.nonce,r.fee):(f=st.SerializeP2SH,l=r.numSignatures,p=r.publicKeys,y=r.nonce,g=r.fee,u={hashMode:f,signer:dr(0,f,l,p.map(Kn)).hash160,nonce:e(y,!1),fee:e(g,!1),fields:[],signaturesRequired:l}),d=r.sponsored?oo(u):ro(u);const w=k.fromNameOrNetwork(r.network),b=[];r.postConditions&&r.postConditions.length>0&&r.postConditions.forEach((t=>{b.push(t)}));const A=br(b),m=new Eo(w.version,d,o,A,r.postConditionMode,r.anchorMode,w.chainId);if(void 0===t.fee||null===t.fee){const t=await async function(t,e){try{const n=function(t){const e=t.auth.spendingCondition.hashMode;if([st.SerializeP2SH,st.SerializeP2WSH].includes(e)){const e=t.auth.spendingCondition,n=e.fields.filter((t=>t.contents.type===z.MessageSignature)).length,r=(e.signaturesRequired-n)*(G+1);return t.serialize().byteLength+r}return t.serialize().byteLength}(t);return(await async function(t,e,n){const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transaction_payload:h(er(t)),...e?{estimated_len:e}:{}})},o=k.fromNameOrNetwork(n??new R),i=o.getTransactionFeeEstimateApiUrl(),s=await o.fetchFn(i,r);if(!s.ok){const t=await s.text().then((t=>{try{return JSON.parse(t)}catch(e){return t}}));if("NoEstimateAvailable"===t?.reason||"string"==typeof t&&t.includes("NoEstimateAvailable"))throw new ir(t?.reason_data?.message??"");throw new Error(`Error estimating transaction fee. Response ${s.status}: ${s.statusText}. Attempted to fetch ${i} and failed with the message: "${t}"`)}return(await s.json()).estimations}(t.payload,n,e))[1].fee}catch(n){if(n instanceof ir)return await async function(t,e){const n=k.fromNameOrNetwork(e??xo(t)),r=n.getTransferFeeEstimateApiUrl(),o=await n.fetchFn(r,{method:"GET",headers:{Accept:"application/text"}});if(!o.ok){let t="";try{t=await o.text()}catch(t){}throw new Error(`Error estimating transaction fee. Response ${o.status}: ${o.statusText}. Attempted to fetch ${r} and failed with the message: "${t}"`)}const i=await o.text(),s=BigInt(t.serialize().byteLength);return BigInt(i)*s}(t,e);throw n}}(m,w);m.setFee(t)}if(void 0===t.nonce||null===t.nonce){const t=w.version===nt.Mainnet?at.MainnetSingleSig:at.TestnetSingleSig,e=(0,U.H4)(t,m.auth.spendingCondition.signer),n=await async function(t,e){const n=k.fromNameOrNetwork(e??new R),r=n.getAccountApiUrl(t),o=await n.fetchFn(r);if(!o.ok){let t="";try{t=await o.text()}catch(t){}throw new Error(`Error fetching nonce. Response ${o.status}: ${o.statusText}. Attempted to fetch ${r} and failed with the message: "${t}"`)}const i=await o.text(),s=JSON.parse(i);return BigInt(s.nonce)}(e,w);m.setNonce(n)}return m}async function Io(t){if("senderKey"in t){const e=h(zn(Gn(t.senderKey)).data),n=Fr(t,"senderKey"),r=await vo({publicKey:e,...n}),o=Gn(t.senderKey);return new mo(r).signOrigin(o),r}{const n=Fr(t,"signerKeys"),r=await vo(n),o=new mo(r);let i=t.publicKeys;for(const e of t.signerKeys){const t=jn(e);i=i.filter((e=>e!==h(t.data))),o.signOrigin(Gn(e))}for(const t of i)o.appendOrigin((e=d(t),{type:z.PublicKey,data:e}));return r}var e}async function _o(t){const e={network:new R},n=Object.assign(e,t),{contractName:r,contractAddress:o,functionName:i,functionArgs:s,senderAddress:a}=n,c=k.fromNameOrNetwork(n.network),u=c.getReadOnlyFunctionCallApiUrl(o,r,i),d=s.map((t=>`0x${h(Sr(t))}`)),f=JSON.stringify({sender:a,arguments:d}),l=await c.fetchFn(u,{method:"POST",body:f,headers:{"Content-Type":"application/json"}});if(!l.ok){const t=await l.text().catch((()=>""));throw new Error(`Error calling read-only function. Response ${l.status}: ${l.statusText}. Attempted to fetch ${u} and failed with the message: "${t}"`)}return l.json().then((t=>(t=>{if(t.okay)return Dr(t.result);throw new Error(t.cause)})(t)))}var Co=(t=>(t[t.P2PKH=0]="P2PKH",t[t.P2SH=1]="P2SH",t[t.P2SHP2WPKH=2]="P2SHP2WPKH",t[t.P2SHP2WSH=3]="P2SHP2WSH",t[t.P2WPKH=4]="P2WPKH",t[t.P2WSH=5]="P2WSH",t[t.P2TR=6]="P2TR",t))(Co||{});const To={mainnet:{P2PKH:0,P2SH:5},testnet:{P2PKH:111,P2SH:196},devnet:{P2PKH:111,P2SH:196},mocknet:{P2PKH:111,P2SH:196}},ko=/^(1|3|m|n|2)/,Ro=/^(bc1q|tb1q|bcrt1q)/i,Po=/^(bc1p|tb1p|bcrt1p)/i,Oo={mainnet:"bc",testnet:"tb",devnet:"bcrt",mocknet:"bcrt"},Bo=/^(bc|tb)/i,No=0,Uo=1;var Ho=(t=>(t.Period1="Period1",t.Period2a="Period2a",t.Period2b="Period2b",t.Period3="Period3",t))(Ho||{}),Do=(t=>(t[t.ERR_STACKING_UNREACHABLE=255]="ERR_STACKING_UNREACHABLE",t[t.ERR_STACKING_CORRUPTED_STATE=254]="ERR_STACKING_CORRUPTED_STATE",t[t.ERR_STACKING_INSUFFICIENT_FUNDS=1]="ERR_STACKING_INSUFFICIENT_FUNDS",t[t.ERR_STACKING_INVALID_LOCK_PERIOD=2]="ERR_STACKING_INVALID_LOCK_PERIOD",t[t.ERR_STACKING_ALREADY_STACKED=3]="ERR_STACKING_ALREADY_STACKED",t[t.ERR_STACKING_NO_SUCH_PRINCIPAL=4]="ERR_STACKING_NO_SUCH_PRINCIPAL",t[t.ERR_STACKING_EXPIRED=5]="ERR_STACKING_EXPIRED",t[t.ERR_STACKING_STX_LOCKED=6]="ERR_STACKING_STX_LOCKED",t[t.ERR_STACKING_PERMISSION_DENIED=9]="ERR_STACKING_PERMISSION_DENIED",t[t.ERR_STACKING_THRESHOLD_NOT_MET=11]="ERR_STACKING_THRESHOLD_NOT_MET",t[t.ERR_STACKING_POX_ADDRESS_IN_USE=12]="ERR_STACKING_POX_ADDRESS_IN_USE",t[t.ERR_STACKING_INVALID_POX_ADDRESS=13]="ERR_STACKING_INVALID_POX_ADDRESS",t[t.ERR_STACKING_ALREADY_REJECTED=17]="ERR_STACKING_ALREADY_REJECTED",t[t.ERR_STACKING_INVALID_AMOUNT=18]="ERR_STACKING_INVALID_AMOUNT",t[t.ERR_NOT_ALLOWED=19]="ERR_NOT_ALLOWED",t[t.ERR_STACKING_ALREADY_DELEGATED=20]="ERR_STACKING_ALREADY_DELEGATED",t[t.ERR_DELEGATION_EXPIRES_DURING_LOCK=21]="ERR_DELEGATION_EXPIRES_DURING_LOCK",t[t.ERR_DELEGATION_TOO_MUCH_LOCKED=22]="ERR_DELEGATION_TOO_MUCH_LOCKED",t[t.ERR_DELEGATION_POX_ADDR_REQUIRED=23]="ERR_DELEGATION_POX_ADDR_REQUIRED",t[t.ERR_INVALID_START_BURN_HEIGHT=24]="ERR_INVALID_START_BURN_HEIGHT",t[t.ERR_NOT_CURRENT_STACKER=25]="ERR_NOT_CURRENT_STACKER",t[t.ERR_STACK_EXTEND_NOT_LOCKED=26]="ERR_STACK_EXTEND_NOT_LOCKED",t[t.ERR_STACK_INCREASE_NOT_LOCKED=27]="ERR_STACK_INCREASE_NOT_LOCKED",t[t.ERR_DELEGATION_NO_REWARD_SLOT=28]="ERR_DELEGATION_NO_REWARD_SLOT",t[t.ERR_DELEGATION_WRONG_REWARD_SLOT=29]="ERR_DELEGATION_WRONG_REWARD_SLOT",t[t.ERR_STACKING_IS_DELEGATED=30]="ERR_STACKING_IS_DELEGATED",t[t.ERR_STACKING_NOT_DELEGATED=31]="ERR_STACKING_NOT_DELEGATED",t))(Do||{});function $o(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function Lo(...t){const e=(t,e)=>n=>t(e(n));return{encode:Array.from(t).reverse().reduce(((t,n)=>t?e(t,n.encode):n.encode),void 0),decode:t.reduce(((t,n)=>t?e(t,n.decode):n.decode),void 0)}}function Ko(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("alphabet.encode input should be an array of numbers");return e.map((e=>{if($o(e),e<0||e>=t.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${t.length})`);return t[e]}))},decode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("alphabet.decode input should be array of strings");return e.map((e=>{if("string"!=typeof e)throw new Error(`alphabet.decode: not string element=${e}`);const n=t.indexOf(e);if(-1===n)throw new Error(`Unknown letter: "${e}". Allowed: ${t}`);return n}))}}}function Mo(t=""){if("string"!=typeof t)throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("join.encode input should be array of strings");for(let t of e)if("string"!=typeof t)throw new Error(`join.encode: non-string input=${t}`);return e.join(t)},decode:e=>{if("string"!=typeof e)throw new Error("join.decode input should be string");return e.split(t)}}}function Fo(t,e="="){if($o(t),"string"!=typeof e)throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let t of n)if("string"!=typeof t)throw new Error(`padding.encode: non-string input=${t}`);for(;n.length*t%8;)n.push(e);return n},decode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let t of n)if("string"!=typeof t)throw new Error(`padding.decode: non-string input=${t}`);let r=n.length;if(r*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if(!((r-1)*t%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function jo(t){if("function"!=typeof t)throw new Error("normalize fn should be function");return{encode:t=>t,decode:e=>t(e)}}function Go(t,e,n){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const o=[],i=Array.from(t);for(i.forEach((t=>{if($o(t),t<0||t>=e)throw new Error(`Wrong integer: ${t}`)}));;){let t=0,s=!0;for(let o=r;o<i.length;o++){const a=i[o],c=e*t+a;if(!Number.isSafeInteger(c)||e*t/e!==t||c-a!=e*t)throw new Error("convertRadix: carry overflow");if(t=c%n,i[o]=Math.floor(c/n),!Number.isSafeInteger(i[o])||i[o]*n+t!==c)throw new Error("convertRadix: carry overflow");s&&(i[o]?s=!1:r=o)}if(o.push(t),s)break}for(let e=0;e<t.length-1&&0===t[e];e++)o.push(0);return o.reverse()}const Wo=(t,e)=>e?Wo(e,t%e):t,zo=(t,e)=>t+(e-Wo(t,e));function Vo(t,e,n,r){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(zo(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${zo(e,n)}`);let o=0,i=0;const s=2**n-1,a=[];for(const r of t){if($o(r),r>=2**e)throw new Error(`convertRadix2: invalid data word=${r} from=${e}`);if(o=o<<e|r,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)a.push((o>>i-n&s)>>>0);o&=2**i-1}if(o=o<<n-i&s,!r&&i>=e)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&a.push(o>>>0),a}function qo(t,e=!1){if($o(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(zo(8,t)>32||zo(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Vo(Array.from(n),8,t,!e)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Vo(n,t,8,e))}}}function Xo(t){if("function"!=typeof t)throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch(t){}}}Lo(qo(4),Ko("0123456789ABCDEF"),Mo("")),Lo(qo(5),Ko("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Fo(5),Mo("")),Lo(qo(5),Ko("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Fo(5),Mo("")),Lo(qo(5),Ko("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Mo(""),jo((t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")))),Lo(qo(6),Ko("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Fo(6),Mo("")),Lo(qo(6),Ko("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Fo(6),Mo(""));const Jo=t=>{return Lo(($o(e=58),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Go(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Go(t,e,256))}}),Ko(t),Mo(""));var e},Zo=(Jo("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),Jo("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),Jo("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),Lo(Ko("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Mo(""))),Yo=[996825010,642813549,513874426,1027748829,705979059];function Qo(t){const e=t>>25;let n=(33554431&t)<<5;for(let t=0;t<Yo.length;t++)1==(e>>t&1)&&(n^=Yo[t]);return n}function ti(t,e,n=1){const r=t.length;let o=1;for(let e=0;e<r;e++){const n=t.charCodeAt(e);if(n<33||n>126)throw new Error(`Invalid prefix (${t})`);o=Qo(o)^n>>5}o=Qo(o);for(let e=0;e<r;e++)o=Qo(o)^31&t.charCodeAt(e);for(let t of e)o=Qo(o)^t;for(let t=0;t<6;t++)o=Qo(o);return o^=n,Zo.encode(Vo([o%2**30],30,5,!1))}function ei(t){const e="bech32"===t?1:734539939,n=qo(5),r=n.decode,o=n.encode,i=Xo(r);function s(t,n=90){if("string"!=typeof t)throw new Error("bech32.decode input should be string, not "+typeof t);if(t.length<8||!1!==n&&t.length>n)throw new TypeError(`Wrong string length: ${t.length} (${t}). Expected (8..${n})`);const r=t.toLowerCase();if(t!==r&&t!==t.toUpperCase())throw new Error("String must be lowercase or uppercase");const o=(t=r).lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');const i=t.slice(0,o),s=t.slice(o+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=Zo.decode(s).slice(0,-6),c=ti(i,a,e);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${t}: expected "${c}"`);return{prefix:i,words:a}}return{encode:function(t,n,r=90){if("string"!=typeof t)throw new Error("bech32.encode prefix should be string, not "+typeof t);if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof n);const o=t.length+7+n.length;if(!1!==r&&o>r)throw new TypeError(`Length ${o} exceeds limit ${r}`);return`${t=t.toLowerCase()}1${Zo.encode(n)}${ti(t,n,e)}`},decode:s,decodeToBytes:function(t){const{prefix:e,words:n}=s(t,!1);return{prefix:e,words:n,bytes:r(n)}},decodeUnsafe:Xo(s),fromWords:r,fromWordsUnsafe:i,toWords:o}}const ni=ei("bech32"),ri=ei("bech32m");Lo(qo(4),Ko("0123456789abcdef"),Mo(""),jo((t=>{if("string"!=typeof t||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()})));var oi=o(22),ii=o.n(oi);Rn.hmacSha256Sync=(t,...e)=>{const n=Nn.create(Qt,t);return e.forEach((t=>n.update(t))),n.digest()},o(766);const si=9007199254740991;function ai(t){if(t<0||t>si||t%1!=0)throw new RangeError("value out of range")}const ci="Stacks Signed Message:\n";function ui(t,e=ci){const n="string"==typeof t?f(t):t,r=function(t,e,n=0){return ai(t),e||(e=new Uint8Array(function(t){return ai(t),t<253?1:t<=65535?3:t<=4294967295?5:9}(t))),t<253?D(e,t,n):t<=65535?(D(e,253,n),function(t,e,n=0){t[n+0]=255&e,e>>>=8,t[n+1]=255&e}(e,t,n+1)):t<=4294967295?(D(e,254,n),L(e,t,n+1)):(D(e,255,n),L(e,t>>>0,n+1),L(e,t/4294967296|0,n+5)),e}(n.length);return b(f(e),r,n)}var hi;Rn.hmacSha256Sync=(t,...e)=>{const n=Nn.create(Qt,t);return e.forEach((t=>n.update(t))),n.digest()},function(t){t.InvalidFormat="InvalidFormat",t.IsNotPoint="IsNotPoint"}(hi||(hi={}));const di=new Uint8Array([83,73,80,48,49,56]);function fi(t){return Qt(Sr(t))}function li({message:t,domain:e}){const n=fi(t);if((r=e).type!==Xn.Tuple||!["name","version","chain-id"].every((t=>t in r.data))||!["name","version"].every((t=>r.data[t].type===Xn.StringASCII))||r.data["chain-id"].type!==Xn.UInt)throw new Error("domain parameter must be a valid domain of type TupleCV with keys 'name', 'version', 'chain-id' with respective types StringASCII, StringASCII, UInt");var r;const o=fi(e);return b(di,o,n)}var pi=Object.defineProperty,yi=Object.defineProperties,gi=Object.getOwnPropertyDescriptors,wi=Object.getOwnPropertySymbols,bi=Object.prototype.hasOwnProperty,Ai=Object.prototype.propertyIsEnumerable,mi=(t,e,n)=>e in t?pi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ei=(t,e)=>{for(var n in e||(e={}))bi.call(e,n)&&mi(t,n,e[n]);if(wi)for(var n of wi(e))Ai.call(e,n)&&mi(t,n,e[n]);return t},Si=(t,e)=>yi(t,gi(e));class xi extends Error{constructor(t,e){const n=`'${t}' is not a valid P2PKH/P2SH/P2WPKH/P2WSH/P2TR address`;super(n),this.message=n,this.name=this.constructor.name,this.innerError=e,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}function vi(t){switch(t){case To.mainnet.P2PKH:case To.testnet.P2PKH:return Co.P2PKH;case To.mainnet.P2SH:case To.testnet.P2SH:return Co.P2SH;default:throw new Error("Invalid pox address version")}}function Ii(t){try{if(ko.test(t)){const e=function(t){const e=ii().decode(t),n=e.slice(0,-4),r=e.slice(-4),o=Qt(Qt(n));if(r[0]^o[0]|r[1]^o[1]|r[2]^o[2]|r[3]^o[3])throw new Error("Invalid checksum");if(21!==n.length)throw new TypeError("Invalid address length");return{version:H(n,0),hash:n.slice(1)}}(t);return{version:vi(e.version),data:e.hash}}if(Bo.test(t)){const e=function(t){if(Ro.test(t))return function(t){const{words:e}=ni.decode(t),n=e[0];if(n>0)throw new Error("Addresses with a witness version >= 1 should be encoded in bech32m");return{witnessVersion:n,data:ni.fromWords(e.slice(1))}}(t);if(Po.test(t))return function(t){const{words:e}=ri.decode(t),n=e[0];if(0==n)throw new Error("Addresses with witness version 1 should be encoded in bech32");return{witnessVersion:n,data:ri.fromWords(e.slice(1))}}(t);throw new Error(`Native segwit address ${t} does not match valid prefix ${Ro} or ${Po}`)}(t);return{version:function(t,e){if(t===No&&20===e)return Co.P2WPKH;if(t===No&&32===e)return Co.P2WSH;if(t===Uo&&32===e)return Co.P2TR;throw new Error("Invalid native segwit witness version and byte length. Currently, only P2WPKH, P2WSH, and P2TR are supported.")}(e.witnessVersion,e.data.length),data:e.data}}throw new Error("Unknown BTC address prefix.")}catch(e){throw new xi(t,e)}}function _i(t){const e=t;if(e.type!==Xn.Tuple||!e.data)throw new Error("Invalid argument, expected ClarityValue to be a TupleCV");if(!("version"in e.data)||!("hashbytes"in e.data))throw new Error("Invalid argument, expected Clarity tuple value to contain `version` and `hashbytes` keys");const n=e.data.version,r=e.data.hashbytes;if(n.type!==Xn.Buffer||r.type!==Xn.Buffer)throw new Error("Invalid argument, expected Clarity tuple value to contain `version` and `hashbytes` buffers");return{version:n.buffer[0],hashBytes:r.buffer}}function Ci(t){switch(t){case Do.ERR_STACKING_UNREACHABLE:return"Stacking unreachable";case Do.ERR_STACKING_CORRUPTED_STATE:return"Stacking state is corrupted";case Do.ERR_STACKING_INSUFFICIENT_FUNDS:return"Insufficient funds";case Do.ERR_STACKING_INVALID_LOCK_PERIOD:return"Invalid lock period";case Do.ERR_STACKING_ALREADY_STACKED:return"Account already stacked. Concurrent stacking not allowed.";case Do.ERR_STACKING_NO_SUCH_PRINCIPAL:return"Principal does not exist";case Do.ERR_STACKING_EXPIRED:return"Stacking expired";case Do.ERR_STACKING_STX_LOCKED:return"STX balance is locked";case Do.ERR_STACKING_PERMISSION_DENIED:return"Permission denied";case Do.ERR_STACKING_THRESHOLD_NOT_MET:return"Stacking threshold not met";case Do.ERR_STACKING_POX_ADDRESS_IN_USE:return"PoX address already in use";case Do.ERR_STACKING_INVALID_POX_ADDRESS:return"Invalid PoX address";case Do.ERR_STACKING_ALREADY_REJECTED:return"Stacking already rejected";case Do.ERR_STACKING_INVALID_AMOUNT:return"Invalid amount";case Do.ERR_NOT_ALLOWED:return"Stacking not allowed";case Do.ERR_STACKING_ALREADY_DELEGATED:return"Already delegated";case Do.ERR_DELEGATION_EXPIRES_DURING_LOCK:return"Delegation expires during lock period";case Do.ERR_DELEGATION_TOO_MUCH_LOCKED:return"Delegation too much locked";case Do.ERR_DELEGATION_POX_ADDR_REQUIRED:return"PoX address required for delegation";case Do.ERR_INVALID_START_BURN_HEIGHT:return"Invalid start burn height";case Do.ERR_NOT_CURRENT_STACKER:return"ERR_NOT_CURRENT_STACKER";case Do.ERR_STACK_EXTEND_NOT_LOCKED:case Do.ERR_STACK_INCREASE_NOT_LOCKED:return"Stacker must be currently locked";case Do.ERR_DELEGATION_NO_REWARD_SLOT:return"Invalid reward-cycle and reward-cycle-index";case Do.ERR_DELEGATION_WRONG_REWARD_SLOT:return"PoX address must match the one on record";case Do.ERR_STACKING_IS_DELEGATED:return"Stacker must be directly stacking and not delegating";case Do.ERR_STACKING_NOT_DELEGATED:return"Stacker must be delegating and not be directly stacking"}}function Ti(t){const{version:e,data:n}=Ii(t);return Or({version:Tr(c(BigInt(e),1)),hashbytes:Tr(n)})}function ki(t,e,n){if(!T.includes(n))throw new Error("Invalid network.");switch(t){case Co.P2PKH:case Co.P2SH:case Co.P2SHP2WPKH:case Co.P2SHP2WSH:{const r=function(t,e){switch(t){case Co.P2PKH:return To[e].P2PKH;case Co.P2SH:case Co.P2SHP2WPKH:case Co.P2SHP2WSH:return To[e].P2SH;default:throw new Error("Invalid pox address version")}}(t,n);return function(t,e){return function(t){const e=Qt(Qt(t));return ii().encode(b(t,e).slice(0,t.length+4))}(b(new Uint8Array([t]),e.slice(0,20)))}(r,e)}case Co.P2WPKH:case Co.P2WSH:{const t=ni.toWords(e);return ni.encode(Oo[n],[No,...t])}case Co.P2TR:{const t=ri.toWords(e);return ri.encode(Oo[n],[Uo,...t])}}throw new Error(`Unexpected address version: ${t}`)}function Ri(...t){return"number"==typeof t[0]?ki(t[0],t[1],t[2]):function(t,e){const n=_i(t);return ki(n.version,n.hashBytes,e)}(t[0],t[1])}function Pi(t){if(t.type===Xn.OptionalSome)return t.value;if(t.type!==Xn.OptionalNone)throw new Error("Object is not an 'Optional'")}function Oi(t,e){if(t.type===Xn.OptionalSome)return e(t.value);if(t.type!==Xn.OptionalNone)throw new Error("Object is not an 'Optional'")}function Bi(t){if(t.period===Ho.Period1)throw new Error(`PoX-2 has not activated yet (currently in period ${t.period} of PoX-2 operation)`)}function Ni({contract:t,poxAddress:e}){if(e&&t.endsWith(".pox")&&!ko.test(e))throw new Error("PoX-1 requires P2PKH/P2SH/P2SH-P2WPKH/P2SH-P2WSH bitcoin addresses")}function Ui({contract:t,signerKey:e,signerSignature:n,maxAmount:r,authId:o}){const i=void 0!==r,s=void 0!==o;if(/\.pox(-[2-3])?$/.test(t)){if(e||n||i||s)throw new Error("PoX-1, PoX-2 and PoX-3 do not accept a `signerKey`, `signerSignature`, `maxAmount` or `authId`")}else if(!e||!i||void 0===o)throw new Error("PoX-4 requires a `signerKey` (buff 33), `maxAmount` (uint), and `authId` (uint)")}var Hi=(t=>(t.StackStx="stack-stx",t.AggregateCommit="agg-commit",t.AggregateIncrease="agg-increase",t.StackExtend="stack-extend",t.StackIncrease="stack-increase",t))(Hi||{});function Di({topic:t,poxAddress:e,rewardCycle:n,period:r,network:o,privateKey:i,maxAmount:s,authId:a}){return function({message:t,domain:e,privateKey:n}){const r=h(Qt(li({message:t,domain:e}))),{data:o}=function({messageHash:t,privateKey:e}){const n=Wn(e,t);return{...n,data:(r=n.data,r.slice(2)+r.slice(0,2))};var r}({messageHash:r,privateKey:n});return{data:o,type:z.StructuredDataSignature}}(Si(Ei({},Li({topic:t,poxAddress:e,rewardCycle:n,period:r,network:o,maxAmount:s,authId:a})),{privateKey:i})).data}function $i({topic:t,poxAddress:e,rewardCycle:n,period:o,network:i,publicKey:s,signature:a,maxAmount:c,authId:u}){return function({signature:t,message:e,publicKey:n}){return function({signature:t,message:e,publicKey:n}){const{r:o,s:i}=Hn(t),s=new Ze(r(o),r(i)),a=Cn(s,"string"==typeof e?function(t,e=ci){return Qt(ui(t,e))}(e):e,n,{strict:!1});return a||"string"!=typeof e?a:Cn(s,Qt(ui(e,"Stacks Message Signing:\n")),n,{strict:!1})}({signature:Dn(t),message:e,publicKey:n})}({message:Qt(li(Li({topic:t,poxAddress:e,rewardCycle:n,period:o,network:i,maxAmount:c,authId:u}))),publicKey:s,signature:a})}function Li({topic:t,poxAddress:e,rewardCycle:n,period:r,network:o,maxAmount:i,authId:s}){return{message:Or({"pox-addr":Ti(e),"reward-cycle":Cr(n),topic:Hr(t),period:Cr(r),"max-amount":Cr(i),"auth-id":Cr(s)}),domain:Or({name:Hr("pox-4-signer"),version:Hr("1.0.0"),"chain-id":Cr(o.chainId)})}}var Ki=Object.defineProperty,Mi=Object.getOwnPropertySymbols,Fi=Object.prototype.hasOwnProperty,ji=Object.prototype.propertyIsEnumerable,Gi=(t,e,n)=>e in t?Ki(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wi=(t,e)=>{for(var n in e||(e={}))Fi.call(e,n)&&Gi(t,n,e[n]);if(Mi)for(var n of Mi(e))ji.call(e,n)&&Gi(t,n,e[n]);return t},zi=(t,e)=>{var n={};for(var r in t)Fi.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&Mi)for(var r of Mi(t))e.indexOf(r)<0&&ji.call(t,r)&&(n[r]=t[r]);return n};class Vi{constructor(t,e){this.address=t,this.network=e}async getCoreInfo(){const t=this.network.getInfoUrl();return this.network.fetchFn(t).then((t=>t.json()))}async getPoxInfo(){const t=this.network.getPoxInfoUrl();return this.network.fetchFn(t).then((t=>t.json()))}async getTargetBlockTime(){const t=this.network.getBlockTimeInfoUrl(),e=await this.network.fetchFn(t).then((t=>t.json()));return this.network.isMainnet()?e.mainnet.target_block_time:e.testnet.target_block_time}async getAccountStatus(){const t=this.network.getAccountApiUrl(this.address);return this.network.fetchFn(t).then((t=>t.json()))}async getAccountBalance(){return this.getAccountStatus().then((t=>BigInt(t.balance)))}async getAccountExtendedBalances(){const t=this.network.getAccountExtendedBalancesApiUrl(this.address);return this.network.fetchFn(t).then((t=>t.json()))}async getAccountBalanceLocked(){return this.getAccountStatus().then((t=>BigInt(t.locked)))}async getCycleDuration(){const t=this.getPoxInfo(),e=await this.getTargetBlockTime();return Promise.all([t,e]).then((([t,e])=>t.reward_cycle_length*e))}async getRewardsTotalForBtcAddress(){const t=this.network.getRewardsTotalUrl(this.address);return this.network.fetchFn(t).then((t=>t.json()))}async getRewardsForBtcAddress(t){const e=`${this.network.getRewardsUrl(this.address,t)}`;return this.network.fetchFn(e).then((t=>t.json()))}async getRewardHoldersForBtcAddress(t){const e=`${this.network.getRewardHoldersUrl(this.address,t)}`;return this.network.fetchFn(e).then((t=>t.json()))}async getRewardSet(t){const[e,n]=this.parseContractId(null==t?void 0:t.contractId);return Oi(await _o({network:this.network,senderAddress:this.address,contractAddress:e,contractName:n,functionArgs:[Cr(t.rewardCyleId),Cr(t.rewardSetIndex)],functionName:"get-reward-set-pox-address"}),(t=>({pox_address:{version:t.data["pox-addr"].data.version.buffer,hashbytes:t.data["pox-addr"].data.hashbytes.buffer},total_ustx:t.data["total-ustx"].value})))}async getSecondsUntilNextCycle(){const t=this.getPoxInfo(),e=this.getTargetBlockTime(),n=this.getCoreInfo();return Promise.all([t,e,n]).then((([t,e,n])=>(t.reward_cycle_length-(n.burn_block_height-t.first_burnchain_block_height)%t.reward_cycle_length)*e))}async getSecondsUntilStackingDeadline(){const t=this.getPoxInfo(),e=this.getTargetBlockTime();return Promise.all([t,e]).then((([t,e])=>t.next_cycle.blocks_until_prepare_phase*e))}async getPoxOperationInfo(t){const e=[...(t=null!=t?t:await this.getPoxInfo()).contract_versions].sort(((t,e)=>t.activation_burnchain_block_height-e.activation_burnchain_block_height)),[n,r,o,i]=e,s=e.filter((e=>(null==t?void 0:t.current_burnchain_block_height)>=e.activation_burnchain_block_height)),a=s[s.length-1];return{period:Ho.Period3,pox1:n,pox2:r,pox3:o,pox4:i,current:a}}async hasMinimumStx(){return await this.getAccountBalance()>=BigInt((await this.getPoxInfo()).min_amount_ustx)}async canStack({poxAddress:t,cycles:e}){const n=this.getAccountBalance(),r=this.getPoxInfo();return Promise.all([n,r]).then((([n,r])=>{const o=Ti(t),[i,s]=this.parseContractId(r.contract_id);return _o({network:this.network,contractName:s,contractAddress:i,functionName:"can-stack-stx",senderAddress:this.address,functionArgs:[o,Cr(n.toString()),Cr(r.reward_cycle_id),Cr(e.toString())]})})).then((t=>t.type===Xn.ResponseOk?{eligible:!0}:{eligible:!1,reason:Do[+so(t.value)]}))}async stack(t){var e=t,{amountMicroStx:n,poxAddress:r,cycles:o,burnBlockHeight:i,signerKey:s,signerSignature:a,maxAmount:c,authId:u}=e,h=zi(e,["amountMicroStx","poxAddress","cycles","burnBlockHeight","signerKey","signerSignature","maxAmount","authId"]);const d=await this.getPoxInfo(),f=await this.getPoxOperationInfo(d),l=await this.getStackingContract(f);Ni({contract:l,poxAddress:r}),Ui({contract:l,signerKey:s,signerSignature:a,maxAmount:c,authId:u});const p=this.getStackOptions({contract:l,amountMicroStx:n,cycles:o,poxAddress:r,burnBlockHeight:i,signerKey:s,signerSignature:a,maxAmount:c,authId:u});return So(await Io(Wi(Wi({},p),qi(h))),p.network)}async stackExtend(t){var e=t,{extendCycles:n,poxAddress:r,signerKey:o,signerSignature:i,maxAmount:s,authId:a}=e,c=zi(e,["extendCycles","poxAddress","signerKey","signerSignature","maxAmount","authId"]);const u=await this.getPoxInfo();Bi(await this.getPoxOperationInfo(u)),Ui({contract:u.contract_id,signerKey:o,signerSignature:i,maxAmount:s,authId:a});const h=this.getStackExtendOptions({contract:u.contract_id,extendCycles:n,poxAddress:r,signerKey:o,signerSignature:i,maxAmount:s,authId:a});return So(await Io(Wi(Wi({},h),qi(c))),h.network)}async stackIncrease(t){var e=t,{increaseBy:n,signerKey:r,signerSignature:o,maxAmount:i,authId:s}=e,a=zi(e,["increaseBy","signerKey","signerSignature","maxAmount","authId"]);const c=await this.getPoxInfo();Bi(await this.getPoxOperationInfo(c)),Ui({contract:c.contract_id,signerKey:r,signerSignature:o,maxAmount:i,authId:s});const u=this.getStackIncreaseOptions({contract:c.contract_id,increaseBy:n,signerKey:r,signerSignature:o,maxAmount:i,authId:s});return So(await Io(Wi(Wi({},u),qi(a))),u.network)}async delegateStx(t){var e=t,{amountMicroStx:n,delegateTo:r,untilBurnBlockHeight:o,poxAddress:i}=e,s=zi(e,["amountMicroStx","delegateTo","untilBurnBlockHeight","poxAddress"]);const a=await this.getPoxInfo(),c=await this.getPoxOperationInfo(a),u=await this.getStackingContract(c);Ni({contract:u,poxAddress:i});const h=this.getDelegateOptions({contract:u,amountMicroStx:n,delegateTo:r,untilBurnBlockHeight:o,poxAddress:i});return So(await Io(Wi(Wi({},h),qi(s))),h.network)}async delegateStackStx(t){var e=t,{stacker:n,amountMicroStx:r,poxAddress:o,burnBlockHeight:i,cycles:s}=e,a=zi(e,["stacker","amountMicroStx","poxAddress","burnBlockHeight","cycles"]);const c=await this.getPoxInfo(),u=await this.getPoxOperationInfo(c),h=await this.getStackingContract(u);Ni({contract:h,poxAddress:o});const d=this.getDelegateStackOptions({contract:h,stacker:n,amountMicroStx:r,poxAddress:o,burnBlockHeight:i,cycles:s});return So(await Io(Wi(Wi({},d),qi(a))),d.network)}async delegateStackExtend(t){var e=t,{stacker:n,poxAddress:r,extendCount:o}=e,i=zi(e,["stacker","poxAddress","extendCount"]);const s=(await this.getPoxInfo()).contract_id,a=this.getDelegateStackExtendOptions({contract:s,stacker:n,poxAddress:r,extendCount:o});return So(await Io(Wi(Wi({},a),qi(i))),a.network)}async delegateStackIncrease(t){var e=t,{stacker:n,poxAddress:r,increaseBy:o}=e,i=zi(e,["stacker","poxAddress","increaseBy"]);const s=await this.getPoxInfo();Bi(await this.getPoxOperationInfo(s));const a=this.getDelegateStackIncreaseOptions({contract:s.contract_id,stacker:n,poxAddress:r,increaseBy:o});return So(await Io(Wi(Wi({},a),qi(i))),a.network)}async stackAggregationCommit(t){var e=t,{poxAddress:n,rewardCycle:r,signerKey:o,signerSignature:i,maxAmount:s,authId:a}=e,c=zi(e,["poxAddress","rewardCycle","signerKey","signerSignature","maxAmount","authId"]);const u=await this.getStackingContract();Ni({contract:u,poxAddress:n}),Ui({contract:u,signerKey:o,signerSignature:i,maxAmount:s,authId:a});const h=this.getStackAggregationCommitOptions({contract:u,poxAddress:n,rewardCycle:r,signerKey:o,signerSignature:i,maxAmount:s,authId:a});return So(await Io(Wi(Wi({},h),qi(c))),h.network)}async stackAggregationCommitIndexed(t){var e=t,{poxAddress:n,rewardCycle:r,signerKey:o,signerSignature:i,maxAmount:s,authId:a}=e,c=zi(e,["poxAddress","rewardCycle","signerKey","signerSignature","maxAmount","authId"]);const u=await this.getStackingContract();Ni({contract:u,poxAddress:n}),Ui({contract:u,signerKey:o,signerSignature:i,maxAmount:s,authId:a});const h=this.getStackAggregationCommitOptionsIndexed({contract:u,poxAddress:n,rewardCycle:r,signerKey:o,signerSignature:i,maxAmount:s,authId:a});return So(await Io(Wi(Wi({},h),qi(c))),h.network)}async stackAggregationIncrease(t){var e=t,{poxAddress:n,rewardCycle:r,rewardIndex:o,signerKey:i,signerSignature:s,maxAmount:a,authId:c}=e,u=zi(e,["poxAddress","rewardCycle","rewardIndex","signerKey","signerSignature","maxAmount","authId"]);const h=await this.getStackingContract();Ni({contract:h,poxAddress:n}),Ui({contract:h,signerKey:i,signerSignature:s,maxAmount:a,authId:c});const d=this.getStackAggregationIncreaseOptions({contract:h,poxAddress:n,rewardCycle:r,rewardCycleIndex:o,signerKey:i,signerSignature:s,maxAmount:a,authId:c});return So(await Io(Wi(Wi({},d),qi(u))),d.network)}async revokeDelegateStx(t){"string"==typeof t&&(t={privateKey:t});const e=(await this.getPoxInfo()).contract_id,n=this.getRevokeDelegateStxOptions(e);return So(await Io(Wi(Wi({},n),qi(t))),n.network)}getStackOptions({amountMicroStx:t,poxAddress:e,cycles:n,contract:r,burnBlockHeight:o,signerKey:i,signerSignature:s,maxAmount:a,authId:c}){const u=Ti(e),[h,f]=this.parseContractId(r),l=[Cr(t),u,Cr(o),Cr(n)];return i&&a&&void 0!==c&&(l.push(s?tr(Tr(d(s))):Qn()),l.push(Tr(d(i))),l.push(Cr(a)),l.push(Cr(c))),{contractAddress:h,contractName:f,functionName:"stack-stx",functionArgs:l,validateWithAbi:!0,network:this.network,anchorMode:X.Any}}getStackExtendOptions({extendCycles:t,poxAddress:e,contract:n,signerKey:r,signerSignature:o,maxAmount:i,authId:s}){const a=Ti(e),[c,u]=this.parseContractId(n),h=[Cr(t),a];return r&&i&&void 0!==s&&(h.push(o?tr(Tr(d(o))):Qn()),h.push(Tr(d(r))),h.push(Cr(i)),h.push(Cr(s))),{contractAddress:c,contractName:u,functionName:"stack-extend",functionArgs:h,validateWithAbi:!0,network:this.network,anchorMode:X.Any}}getStackIncreaseOptions({increaseBy:t,contract:e,signerKey:n,signerSignature:r,maxAmount:o,authId:i}){const[s,a]=this.parseContractId(e),c=[Cr(t)];return n&&o&&void 0!==i&&(c.push(r?tr(Tr(d(r))):Qn()),c.push(Tr(d(n))),c.push(Cr(o)),c.push(Cr(i))),{contractAddress:s,contractName:a,functionName:"stack-increase",functionArgs:c,validateWithAbi:!0,network:this.network,anchorMode:X.Any}}getDelegateOptions({contract:t,amountMicroStx:e,delegateTo:n,untilBurnBlockHeight:r,poxAddress:o}){const i=o?tr(Ti(o)):Qn(),[s,a]=this.parseContractId(t);return{contractAddress:s,contractName:a,functionName:"delegate-stx",functionArgs:[Cr(e),Rr(n),r?tr(Cr(r)):Qn(),i],validateWithAbi:!0,network:this.network,anchorMode:X.Any}}getDelegateStackOptions({contract:t,stacker:e,amountMicroStx:n,poxAddress:r,burnBlockHeight:o,cycles:i}){const s=Ti(r),[a,c]=this.parseContractId(t);return{contractAddress:a,contractName:c,functionName:"delegate-stack-stx",functionArgs:[Rr(e),Cr(n),s,Cr(o),Cr(i)],validateWithAbi:!0,network:this.network,anchorMode:X.Any}}getDelegateStackExtendOptions({contract:t,stacker:e,poxAddress:n,extendCount:r}){const o=Ti(n),[i,s]=this.parseContractId(t);return{contractAddress:i,contractName:s,functionName:"delegate-stack-extend",functionArgs:[Rr(e),o,Cr(r)],validateWithAbi:!0,network:this.network,anchorMode:X.Any}}getDelegateStackIncreaseOptions({contract:t,stacker:e,poxAddress:n,increaseBy:r}){const o=Ti(n),[i,s]=this.parseContractId(t);return{contractAddress:i,contractName:s,functionName:"delegate-stack-increase",functionArgs:[Rr(e),o,Cr(r)],validateWithAbi:!0,network:this.network,anchorMode:X.Any}}getStackAggregationCommitOptions({contract:t,poxAddress:e,rewardCycle:n,signerKey:r,signerSignature:o,maxAmount:i,authId:s}){const a=Ti(e),[c,u]=this.parseContractId(t),h=[a,Cr(n)];return r&&i&&void 0!==s&&(h.push(o?tr(Tr(d(o))):Qn()),h.push(Tr(d(r))),h.push(Cr(i)),h.push(Cr(s))),{contractAddress:c,contractName:u,functionName:"stack-aggregation-commit",functionArgs:h,validateWithAbi:!0,network:this.network,anchorMode:X.Any}}getStackAggregationIncreaseOptions({contract:t,poxAddress:e,rewardCycle:n,rewardCycleIndex:r,signerKey:o,signerSignature:i,maxAmount:s,authId:a}){const c=Ti(e),[u,h]=this.parseContractId(t),f=[c,Cr(n),Cr(r)];return o&&s&&void 0!==a&&(f.push(i?tr(Tr(d(i))):Qn()),f.push(Tr(d(o))),f.push(Cr(s)),f.push(Cr(a))),{contractAddress:u,contractName:h,functionName:"stack-aggregation-increase",functionArgs:f,validateWithAbi:!0,network:this.network,anchorMode:X.Any}}getStackAggregationCommitOptionsIndexed({contract:t,poxAddress:e,rewardCycle:n,signerKey:r,signerSignature:o,maxAmount:i,authId:s}){const a=Ti(e),[c,u]=this.parseContractId(t),h=[a,Cr(n)];return r&&i&&void 0!==s&&(h.push(o?tr(Tr(d(o))):Qn()),h.push(Tr(d(r))),h.push(Cr(i)),h.push(Cr(s))),{contractAddress:c,contractName:u,functionName:"stack-aggregation-commit-indexed",functionArgs:h,validateWithAbi:!0,network:this.network,anchorMode:X.Any}}getRevokeDelegateStxOptions(t){const[e,n]=this.parseContractId(t);return{contractAddress:e,contractName:n,functionName:"revoke-delegate-stx",functionArgs:[],validateWithAbi:!0,network:this.network,anchorMode:X.Any}}async getStatus(){const t=await this.getPoxInfo(),[e,n]=this.parseContractId(t.contract_id),r=await this.getAccountStatus();return _o({contractAddress:e,contractName:n,functionName:"get-stacker-info",senderAddress:this.address,functionArgs:[Rr(this.address)],network:this.network}).then((t=>{if(t.type===Xn.OptionalSome){const e=t.value,n=e.data["pox-addr"],o=e.data["first-reward-cycle"],i=e.data["lock-period"],s=n.data.version,a=n.data.hashbytes;return{stacked:!0,details:{first_reward_cycle:Number(o.value),lock_period:Number(i.value),unlock_height:r.unlock_height,pox_address:{version:s.buffer,hashbytes:a.buffer}}}}if(t.type===Xn.OptionalNone)return{stacked:!1};throw new Error("Error fetching stacker info")}))}async getDelegationStatus(){const t=await this.getPoxInfo(),[e,n]=this.parseContractId(t.contract_id);return _o({contractAddress:e,contractName:n,functionName:"get-delegation-info",senderAddress:this.address,functionArgs:[Rr(this.address)],network:this.network}).then((t=>{if(t.type===Xn.OptionalSome){const e=t.value,n=e.data["amount-ustx"],r=e.data["delegated-to"],o=Oi(e.data["pox-addr"],(t=>({version:t.data.version.buffer,hashbytes:t.data.hashbytes.buffer}))),i=Pi(e.data["until-burn-ht"]);return{delegated:!0,details:{amount_micro_stx:BigInt(n.value),delegated_to:kr(r),pox_address:o,until_burn_ht:i?Number(i.value):void 0}}}if(t.type===Xn.OptionalNone)return{delegated:!1};throw new Error("Error fetching delegation info")}))}async verifySignerKeySignature({topic:t,poxAddress:e,rewardCycle:n,period:r,signerSignature:o,signerKey:i,amount:s,maxAmount:a,authId:c}){const u=await this.getPoxInfo(),[h,f]=this.parseContractId(u.contract_id);return _o({contractAddress:h,contractName:f,functionName:"verify-signer-key-sig",functionArgs:[Ti(e),Cr(n),Hr(t),Cr(r),o?tr(Tr(d(o))):Qn(),Tr(d(i)),Cr(s),Cr(a),Cr(c)],network:this.network,senderAddress:this.address}).then((t=>t.type===Xn.ResponseOk))}async getStackingContract(t){switch((t=null!=t?t:await this.getPoxOperationInfo()).period){case Ho.Period1:return t.pox1.contract_id;case Ho.Period2a:case Ho.Period2b:return t.pox2.contract_id;case Ho.Period3:default:return t.current.contract_id}}modifyLockTxFee({tx:t,amountMicroStx:n}){const r=function(t){switch(t.authType){case it.Standard:return t.spendingCondition.fee;case it.Sponsored:return t.sponsorSpendingCondition.fee}}(t.auth);return t.payload.functionArgs[0]=Cr(e(n,!1)-r),t}parseContractId(t){const e=t.split(".");if(2===e.length&&(t=>{try{return(0,U.yI)(t),!0}catch(t){return!1}})(e[0])&&e[1].startsWith("pox"))return e;throw new Error("Stacking contract ID is malformed")}signPoxSignature({topic:t,poxAddress:e,rewardCycle:n,period:r,signerPrivateKey:o,authId:i,maxAmount:s}){return Di({topic:t,poxAddress:e,rewardCycle:n,period:r,network:this.network,privateKey:o,maxAmount:s,authId:i})}}function qi(t){return t.senderKey=t.privateKey,delete t.privateKey,t}})(),i})()));
//# sourceMappingURL=index.js.map